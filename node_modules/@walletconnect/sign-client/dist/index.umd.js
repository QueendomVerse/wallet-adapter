(function(me,Z){typeof exports=="object"&&typeof module<"u"?Z(exports):typeof define=="function"&&define.amd?define(["exports"],Z):(me=typeof globalThis<"u"?globalThis:me||self,Z(me["@walletconnect/sign-client"]={}))})(this,function(me){"use strict";var Z=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function li(t){var e=t.default;if(typeof e=="function"){var r=function(){return e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(t).forEach(function(i){var n=Object.getOwnPropertyDescriptor(t,i);Object.defineProperty(r,i,n.get?n:{enumerable:!0,get:function(){return t[i]}})}),r}function ma(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var Da=Sa;function Sa(t,e,r){var i=r&&r.stringify||ma,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var u=new Array(s);u[0]=i(t);for(var c=1;c<s;c++)u[c]=i(e[c]);return u.join(" ")}if(typeof t!="string")return t;var h=e.length;if(h===0)return t;for(var f="",d=1-n,m=-1,C=t&&t.length||0,y=0;y<C;){if(t.charCodeAt(y)===37&&y+1<C){switch(m=m>-1?m:0,t.charCodeAt(y+1)){case 100:case 102:if(d>=h||e[d]==null)break;m<y&&(f+=t.slice(m,y)),f+=Number(e[d]),m=y+2,y++;break;case 105:if(d>=h||e[d]==null)break;m<y&&(f+=t.slice(m,y)),f+=Math.floor(Number(e[d])),m=y+2,y++;break;case 79:case 111:case 106:if(d>=h||e[d]===void 0)break;m<y&&(f+=t.slice(m,y));var b=typeof e[d];if(b==="string"){f+="'"+e[d]+"'",m=y+2,y++;break}if(b==="function"){f+=e[d].name||"<anonymous>",m=y+2,y++;break}f+=i(e[d]),m=y+2,y++;break;case 115:if(d>=h)break;m<y&&(f+=t.slice(m,y)),f+=String(e[d]),m=y+2,y++;break;case 37:m<y&&(f+=t.slice(m,y)),f+="%",m=y+2,y++,d--;break}++d}++y}return m===-1?t:(m<C&&(f+=t.slice(m)),f)}var wn=Da,di=xt,lr=La().console||{},xa={mapHttpRequest:jr,mapHttpResponse:jr,wrapRequestSerializer:gi,wrapResponseSerializer:gi,wrapErrorSerializer:gi,req:jr,res:jr,err:Na};function xt(t){t=t||{},t.browser=t.browser||{};var e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");var r=t.browser.write||lr;t.browser.write&&(t.browser.asObject=!0);var i=t.serializers||{},n=Array.isArray(t.browser.serialize)?t.browser.serialize.filter(function(b){return b!=="!stdSerializers.err"}):t.browser.serialize===!0?Object.keys(i):!1,s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);var u=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");var c=t.level||"info",h=Object.create(r);h.log||(h.log=dr),Object.defineProperty(h,"levelVal",{get:d}),Object.defineProperty(h,"level",{get:m,set:C});var f={transmit:e,serialize:n,asObject:t.browser.asObject,levels:u,timestamp:Ta(t)};h.levels=xt.levels,h.level=c,h.setMaxListeners=h.getMaxListeners=h.emit=h.addListener=h.on=h.prependListener=h.once=h.prependOnceListener=h.removeListener=h.removeAllListeners=h.listeners=h.listenerCount=h.eventNames=h.write=h.flush=dr,h.serializers=i,h._serialize=n,h._stdErrSerialize=s,h.child=y,e&&(h._logEvent=pi());function d(){return this.level==="silent"?1/0:this.levels.values[this.level]}function m(){return this._level}function C(b){if(b!=="silent"&&!this.levels.values[b])throw Error("unknown level "+b);this._level=b,er(f,h,"error","log"),er(f,h,"fatal","error"),er(f,h,"warn","error"),er(f,h,"info","log"),er(f,h,"debug","log"),er(f,h,"trace","log")}function y(b){if(!b)throw new Error("missing bindings for child Pino");var L=b.serializers;if(n&&L){var v=Object.assign({},i,L),S=t.browser.serialize===!0?Object.keys(v):n;delete b.serializers,Mr([b],S,v,this._stdErrSerialize)}function R(A){this._childLevel=(A._childLevel|0)+1,this.error=tr(A,b,"error"),this.fatal=tr(A,b,"fatal"),this.warn=tr(A,b,"warn"),this.info=tr(A,b,"info"),this.debug=tr(A,b,"debug"),this.trace=tr(A,b,"trace"),v&&(this.serializers=v,this._serialize=S),e&&(this._logEvent=pi([].concat(A._logEvent.bindings,b)))}return R.prototype=this,new R(this)}return h}xt.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},xt.stdSerializers=xa,xt.stdTimeFunctions=Object.assign({},{nullTime:En,epochTime:mn,unixTime:Ca,isoTime:Ra});function er(t,e,r,i){var n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?dr:n[r]?n[r]:lr[r]||lr[i]||dr,Oa(t,e,r)}function Oa(t,e,r){!t.transmit&&e[r]===dr||(e[r]=function(i){return function(){for(var s=t.timestamp(),u=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===lr?lr:this,h=0;h<u.length;h++)u[h]=arguments[h];if(t.serialize&&!t.asObject&&Mr(u,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(c,Ia(this,r,u,s)):i.apply(c,u),t.transmit){var f=t.transmit.level||e.level,d=xt.levels.values[f],m=xt.levels.values[r];if(m<d)return;Aa(this,{ts:s,methodLevel:r,methodValue:m,transmitLevel:f,transmitValue:xt.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},u)}}}(e[r]))}function Ia(t,e,r,i){t._serialize&&Mr(r,t._serialize,t.serializers,t._stdErrSerialize);var n=r.slice(),s=n[0],u={};i&&(u.time=i),u.level=xt.levels.values[e];var c=(t._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof n[0]=="object";)Object.assign(u,n.shift());s=n.length?wn(n.shift(),n):void 0}else typeof s=="string"&&(s=wn(n.shift(),n));return s!==void 0&&(u.msg=s),u}function Mr(t,e,r,i){for(var n in t)if(i&&t[n]instanceof Error)t[n]=xt.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(var s in t[n])e&&e.indexOf(s)>-1&&s in r&&(t[n][s]=r[s](t[n][s]))}function tr(t,e,r){return function(){var i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function Aa(t,e,r){var i=e.send,n=e.ts,s=e.methodLevel,u=e.methodValue,c=e.val,h=t._logEvent.bindings;Mr(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(f){return h.indexOf(f)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=u,i(s,t._logEvent,c),t._logEvent=pi(h)}function pi(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function Na(t){var e={type:t.constructor.name,msg:t.message,stack:t.stack};for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e}function Ta(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?En:mn}function jr(){return{}}function gi(t){return t}function dr(){}function En(){return!1}function mn(){return Date.now()}function Ca(){return Math.round(Date.now()/1e3)}function Ra(){return new Date(Date.now()).toISOString()}function La(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}var $r={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var vi=function(t,e){return vi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},vi(t,e)};function Pa(t,e){vi(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var _i=function(){return _i=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},_i.apply(this,arguments)};function Fa(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Ua(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,u;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(u=t[c])&&(s=(n<3?u(s):n>3?u(e,r,s):u(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Ma(t,e){return function(r,i){e(r,i,t)}}function ja(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function $a(t,e,r,i){function n(s){return s instanceof r?s:new r(function(u){u(s)})}return new(r||(r=Promise))(function(s,u){function c(d){try{f(i.next(d))}catch(m){u(m)}}function h(d){try{f(i.throw(d))}catch(m){u(m)}}function f(d){d.done?s(d.value):n(d.value).then(c,h)}f((i=i.apply(t,e||[])).next())})}function za(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,u;return u={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(u[Symbol.iterator]=function(){return this}),u;function c(f){return function(d){return h([f,d])}}function h(f){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=f[0]&2?n.return:f[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,f[1])).done)return s;switch(n=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,n=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=e.call(t,r)}catch(d){f=[6,d],n=0}finally{i=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Ba(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Ka(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function yi(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Dn(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],u;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){u={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(u)throw u.error}}return s}function Ha(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Dn(arguments[e]));return t}function Va(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],u=0,c=s.length;u<c;u++,n++)i[n]=s[u];return i}function pr(t){return this instanceof pr?(this.v=t,this):new pr(t)}function qa(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},u("next"),u("throw"),u("return"),n[Symbol.asyncIterator]=function(){return this},n;function u(C){i[C]&&(n[C]=function(y){return new Promise(function(b,L){s.push([C,y,b,L])>1||c(C,y)})})}function c(C,y){try{h(i[C](y))}catch(b){m(s[0][3],b)}}function h(C){C.value instanceof pr?Promise.resolve(C.value.v).then(f,d):m(s[0][2],C)}function f(C){c("next",C)}function d(C){c("throw",C)}function m(C,y){C(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Ga(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(u){return(r=!r)?{value:pr(t[n](u)),done:n==="return"}:s?s(u):u}:s}}function Wa(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof yi=="function"?yi(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(u){return new Promise(function(c,h){u=t[s](u),n(c,h,u.done,u.value)})}}function n(s,u,c,h){Promise.resolve(h).then(function(f){s({value:f,done:c})},u)}}function Ya(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function Xa(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function ka(t){return t&&t.__esModule?t:{default:t}}function Ja(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Za(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}var Qa=Object.freeze({__proto__:null,__extends:Pa,get __assign(){return _i},__rest:Fa,__decorate:Ua,__param:Ma,__metadata:ja,__awaiter:$a,__generator:za,__createBinding:Ba,__exportStar:Ka,__values:yi,__read:Dn,__spread:Ha,__spreadArrays:Va,__await:pr,__asyncGenerator:qa,__asyncDelegator:Ga,__asyncValues:Wa,__makeTemplateObject:Ya,__importStar:Xa,__importDefault:ka,__classPrivateFieldGet:Ja,__classPrivateFieldSet:Za}),bi=li(Qa),zr={exports:{}},Sn;function ec(){return Sn||(Sn=1,function(){var t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){var r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),Z.localStorage?zr.exports=localStorage:zr.exports=new e}()),zr.exports}var gr={},xn;function On(){if(xn)return gr;xn=1,Object.defineProperty(gr,"__esModule",{value:!0});function t(r){if(typeof r!="string")throw new Error(`Cannot safe json parse value of type ${typeof r}`);try{return JSON.parse(r)}catch{return r}}gr.safeJsonParse=t;function e(r){return typeof r=="string"?r:JSON.stringify(r,(i,n)=>typeof n>"u"?null:n)}return gr.safeJsonStringify=e,gr}var wi={},vr={},In;function tc(){if(In)return vr;In=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.IKeyValueStorage=void 0;class t{}return vr.IKeyValueStorage=t,vr}var _r={},An;function rc(){if(An)return _r;An=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.parseEntry=void 0;const t=On();function e(r){var i;return[r[0],t.safeJsonParse((i=r[1])!==null&&i!==void 0?i:"")]}return _r.parseEntry=e,_r}var Nn;function ic(){return Nn||(Nn=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=bi;e.__exportStar(tc(),t),e.__exportStar(rc(),t)}(wi)),wi}Object.defineProperty($r,"__esModule",{value:!0}),$r.KeyValueStorage=void 0;const rr=bi,nc=rr.__importDefault(ec()),Tn=On(),sc=ic();class Cn{constructor(){this.localStorage=nc.default}getKeys(){return rr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return rr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(sc.parseEntry)})}getItem(e){return rr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(e);if(r!==null)return Tn.safeJsonParse(r)})}setItem(e,r){return rr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Tn.safeJsonStringify(r))})}removeItem(e){return rr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}$r.KeyValueStorage=Cn;var oc=$r.default=Cn,yr={},Br={};function He(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var Ht=He;He.EventEmitter=He,He.prototype._events=void 0,He.prototype._maxListeners=void 0,He.defaultMaxListeners=10,He.prototype.setMaxListeners=function(t){if(!ac(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},He.prototype.emit=function(t){var e,r,i,n,s,u;if(this._events||(this._events={}),t==="error"&&(!this._events.error||br(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(r=this._events[t],Rn(r))return!1;if(Nt(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),r.apply(this,n)}else if(br(r))for(n=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,s=0;s<i;s++)u[s].apply(this,n);return!0},He.prototype.addListener=function(t,e){var r;if(!Nt(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,Nt(e.listener)?e.listener:e),this._events[t]?br(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,br(this._events[t])&&!this._events[t].warned&&(Rn(this._maxListeners)?r=He.defaultMaxListeners:r=this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),typeof console.trace=="function"&&console.trace())),this},He.prototype.on=He.prototype.addListener,He.prototype.once=function(t,e){if(!Nt(e))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},He.prototype.removeListener=function(t,e){var r,i,n,s;if(!Nt(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],n=r.length,i=-1,r===e||Nt(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(br(r)){for(s=n;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){i=s;break}if(i<0)return this;r.length===1?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},He.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[t]&&delete this._events[t],this;if(arguments.length===0){for(e in this._events)e!=="removeListener"&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],Nt(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},He.prototype.listeners=function(t){var e;return!this._events||!this._events[t]?e=[]:Nt(this._events[t])?e=[this._events[t]]:e=this._events[t].slice(),e},He.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(Nt(e))return 1;if(e)return e.length}return 0},He.listenerCount=function(t,e){return t.listenerCount(e)};function Nt(t){return typeof t=="function"}function ac(t){return typeof t=="number"}function br(t){return typeof t=="object"&&t!==null}function Rn(t){return t===void 0}var Ie={},Ln={},Kr={};Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.delay=void 0;function cc(t){return new Promise(e=>{setTimeout(()=>{e(!0)},t)})}Kr.delay=cc;var ir={},Ei={},nr={};Object.defineProperty(nr,"__esModule",{value:!0}),nr.ONE_THOUSAND=nr.ONE_HUNDRED=void 0,nr.ONE_HUNDRED=100,nr.ONE_THOUSAND=1e3;var Pn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365})(Pn),function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,u){u===void 0&&(u=s),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,u){u===void 0&&(u=s),i[u]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(nr,t),r(Pn,t)}(Ei),Object.defineProperty(ir,"__esModule",{value:!0}),ir.fromMiliseconds=ir.toMiliseconds=void 0;const Fn=Ei;function uc(t){return t*Fn.ONE_THOUSAND}ir.toMiliseconds=uc;function hc(t){return Math.floor(t/Fn.ONE_THOUSAND)}ir.fromMiliseconds=hc,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,u){u===void 0&&(u=s),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,u){u===void 0&&(u=s),i[u]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Kr,t),r(ir,t)}(Ln);var wr={};Object.defineProperty(wr,"__esModule",{value:!0}),wr.Watch=void 0;class Un{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw new Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){const r=this.get(e);if(typeof r.elapsed<"u")throw new Error(`Watch already stopped for label: ${e}`);const i=Date.now()-r.started;this.timestamps.set(e,{started:r.started,elapsed:i})}get(e){const r=this.timestamps.get(e);if(typeof r>"u")throw new Error(`No timestamp found for label: ${e}`);return r}elapsed(e){const r=this.get(e);return r.elapsed||Date.now()-r.started}}wr.Watch=Un,wr.default=Un;var Mn={},Hr={};Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.IWatch=void 0;class fc{}Hr.IWatch=fc,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,u){u===void 0&&(u=s),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,u){u===void 0&&(u=s),i[u]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Hr,t)}(Mn),function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,u){u===void 0&&(u=s),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,u){u===void 0&&(u=s),i[u]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Ln,t),r(wr,t),r(Mn,t),r(Ei,t)}(Ie);var mi={},Vr={};class Vt{}var lc=Object.freeze({__proto__:null,IEvents:Vt}),dc=li(lc);Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.IHeartBeat=void 0;const pc=dc;class gc extends pc.IEvents{constructor(e){super()}}Vr.IHeartBeat=gc,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,u){u===void 0&&(u=s),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,u){u===void 0&&(u=s),i[u]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Vr,t)}(mi);var Di={},sr={};Object.defineProperty(sr,"__esModule",{value:!0}),sr.HEARTBEAT_EVENTS=sr.HEARTBEAT_INTERVAL=void 0;const vc=Ie;sr.HEARTBEAT_INTERVAL=vc.FIVE_SECONDS,sr.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,u){u===void 0&&(u=s),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,u){u===void 0&&(u=s),i[u]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(sr,t)}(Di);var Si=Z&&Z.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(u){u(s)})}return new(r||(r=Promise))(function(s,u){function c(d){try{f(i.next(d))}catch(m){u(m)}}function h(d){try{f(i.throw(d))}catch(m){u(m)}}function f(d){d.done?s(d.value):n(d.value).then(c,h)}f((i=i.apply(t,e||[])).next())})};Object.defineProperty(Br,"__esModule",{value:!0}),Br.HeartBeat=void 0;const _c=Ht,yc=Ie,bc=mi,xi=Di;class Oi extends bc.IHeartBeat{constructor(e){super(e),this.events=new _c.EventEmitter,this.interval=xi.HEARTBEAT_INTERVAL,this.interval=e?.interval||xi.HEARTBEAT_INTERVAL}static init(e){return Si(this,void 0,void 0,function*(){const r=new Oi(e);return yield r.init(),r})}init(){return Si(this,void 0,void 0,function*(){yield this.initialize()})}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}initialize(){return Si(this,void 0,void 0,function*(){setInterval(()=>this.pulse(),yc.toMiliseconds(this.interval))})}pulse(){this.events.emit(xi.HEARTBEAT_EVENTS.pulse)}}Br.HeartBeat=Oi,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,u){u===void 0&&(u=s),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,u){u===void 0&&(u=s),i[u]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Br,t),r(mi,t),r(Di,t)}(yr);var xe={},qt={},jn;function $n(){return jn||(jn=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.PINO_CUSTOM_CONTEXT_KEY=qt.PINO_LOGGER_DEFAULTS=void 0,qt.PINO_LOGGER_DEFAULTS={level:"info"},qt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),qt}var at={},zn;function wc(){if(zn)return at;zn=1,Object.defineProperty(at,"__esModule",{value:!0}),at.generateChildLogger=at.formatChildLoggerContext=at.getLoggerContext=at.setBrowserLoggerContext=at.getBrowserLoggerContext=at.getDefaultLoggerOptions=void 0;const t=$n();function e(c){return Object.assign(Object.assign({},c),{level:c?.level||t.PINO_LOGGER_DEFAULTS.level})}at.getDefaultLoggerOptions=e;function r(c,h=t.PINO_CUSTOM_CONTEXT_KEY){return c[h]||""}at.getBrowserLoggerContext=r;function i(c,h,f=t.PINO_CUSTOM_CONTEXT_KEY){return c[f]=h,c}at.setBrowserLoggerContext=i;function n(c,h=t.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof c.bindings>"u"?f=r(c,h):f=c.bindings().context||"",f}at.getLoggerContext=n;function s(c,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const d=n(c,f);return d.trim()?`${d}/${h}`:h}at.formatChildLoggerContext=s;function u(c,h,f=t.PINO_CUSTOM_CONTEXT_KEY){const d=s(c,h,f),m=c.child({context:d});return i(m,d,f)}return at.generateChildLogger=u,at}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=bi;e.__exportStar($n(),t),e.__exportStar(wc(),t)})(xe);class Ec extends Vt{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class mc extends Vt{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}}class Dc{constructor(e,r){this.logger=e,this.core=r}}class Sc extends Vt{constructor(e,r){super(),this.relayer=e,this.logger=r}}class xc extends Vt{constructor(e){super()}}class Oc{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}}class Ic extends Vt{constructor(e,r){super(),this.relayer=e,this.logger=r}}function Ve(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var Ac=Ve;Ve.EventEmitter=Ve,Ve.prototype._events=void 0,Ve.prototype._maxListeners=void 0,Ve.defaultMaxListeners=10,Ve.prototype.setMaxListeners=function(t){if(!Nc(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},Ve.prototype.emit=function(t){var e,r,i,n,s,u;if(this._events||(this._events={}),t==="error"&&(!this._events.error||Er(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(r=this._events[t],Bn(r))return!1;if(Tt(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),r.apply(this,n)}else if(Er(r))for(n=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,s=0;s<i;s++)u[s].apply(this,n);return!0},Ve.prototype.addListener=function(t,e){var r;if(!Tt(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,Tt(e.listener)?e.listener:e),this._events[t]?Er(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,Er(this._events[t])&&!this._events[t].warned&&(Bn(this._maxListeners)?r=Ve.defaultMaxListeners:r=this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),typeof console.trace=="function"&&console.trace())),this},Ve.prototype.on=Ve.prototype.addListener,Ve.prototype.once=function(t,e){if(!Tt(e))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},Ve.prototype.removeListener=function(t,e){var r,i,n,s;if(!Tt(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],n=r.length,i=-1,r===e||Tt(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(Er(r)){for(s=n;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){i=s;break}if(i<0)return this;r.length===1?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},Ve.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[t]&&delete this._events[t],this;if(arguments.length===0){for(e in this._events)e!=="removeListener"&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],Tt(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},Ve.prototype.listeners=function(t){var e;return!this._events||!this._events[t]?e=[]:Tt(this._events[t])?e=[this._events[t]]:e=this._events[t].slice(),e},Ve.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(Tt(e))return 1;if(e)return e.length}return 0},Ve.listenerCount=function(t,e){return t.listenerCount(e)};function Tt(t){return typeof t=="function"}function Nc(t){return typeof t=="number"}function Er(t){return typeof t=="object"&&t!==null}function Bn(t){return t===void 0}class Tc{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}class D0 extends Ac.EventEmitter{constructor(){super()}}class Cc{constructor(e){this.client=e}}class Rc extends Vt{constructor(e,r){super(),this.core=e,this.logger=r}}function Kn(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return JSON.parse(t)}catch{return t}}function Ii(t){return typeof t=="string"?t:JSON.stringify(t)}var Ai={},or={},Ni={},Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});var Hn=65536,Lc=function(){function t(){this.isAvailable=!1,this.isInstantiated=!1;var e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");for(var r=new Uint8Array(e),i=0;i<r.length;i+=Hn)this._crypto.getRandomValues(r.subarray(i,i+Math.min(r.length-i,Hn)));return r},t}();Ti.BrowserRandomSource=Lc;function Pc(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Ci={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});function Fc(t){for(var e=0;e<t.length;e++)t[e]=0;return t}dt.wipe=Fc;var Uc={},Mc=Object.freeze({__proto__:null,default:Uc}),jc=li(Mc);Object.defineProperty(Ci,"__esModule",{value:!0});var $c=dt,zc=function(){function t(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Pc<"u"){var e=jc;e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}return t.prototype.randomBytes=function(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");var r=this._crypto.randomBytes(e);if(r.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");for(var i=new Uint8Array(e),n=0;n<i.length;n++)i[n]=r[n];return $c.wipe(r),i},t}();Ci.NodeRandomSource=zc,Object.defineProperty(Ni,"__esModule",{value:!0});var Bc=Ti,Kc=Ci,Hc=function(){function t(){if(this.isAvailable=!1,this.name="",this._source=new Bc.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Kc.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}return t.prototype.randomBytes=function(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)},t}();Ni.SystemRandomSource=Hc;var te={},Vn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});function e(c,h){var f=c>>>16&65535,d=c&65535,m=h>>>16&65535,C=h&65535;return d*C+(f*C+d*m<<16>>>0)|0}t.mul=Math.imul||e;function r(c,h){return c+h|0}t.add=r;function i(c,h){return c-h|0}t.sub=i;function n(c,h){return c<<h|c>>>32-h}t.rotl=n;function s(c,h){return c<<32-h|c>>>h}t.rotr=s;function u(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}t.isInteger=Number.isInteger||u,t.MAX_SAFE_INTEGER=9007199254740991,t.isSafeInteger=function(c){return t.isInteger(c)&&c>=-t.MAX_SAFE_INTEGER&&c<=t.MAX_SAFE_INTEGER}})(Vn),Object.defineProperty(te,"__esModule",{value:!0});var qn=Vn;function Vc(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])<<16>>16}te.readInt16BE=Vc;function qc(t,e){return e===void 0&&(e=0),(t[e+0]<<8|t[e+1])>>>0}te.readUint16BE=qc;function Gc(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])<<16>>16}te.readInt16LE=Gc;function Wc(t,e){return e===void 0&&(e=0),(t[e+1]<<8|t[e])>>>0}te.readUint16LE=Wc;function Gn(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>8,e[r+1]=t>>>0,e}te.writeUint16BE=Gn,te.writeInt16BE=Gn;function Wn(t,e,r){return e===void 0&&(e=new Uint8Array(2)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e}te.writeUint16LE=Wn,te.writeInt16LE=Wn;function Ri(t,e){return e===void 0&&(e=0),t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}te.readInt32BE=Ri;function Li(t,e){return e===void 0&&(e=0),(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}te.readUint32BE=Li;function Pi(t,e){return e===void 0&&(e=0),t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}te.readInt32LE=Pi;function Fi(t,e){return e===void 0&&(e=0),(t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e])>>>0}te.readUint32LE=Fi;function qr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>24,e[r+1]=t>>>16,e[r+2]=t>>>8,e[r+3]=t>>>0,e}te.writeUint32BE=qr,te.writeInt32BE=qr;function Gr(t,e,r){return e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0),e[r+0]=t>>>0,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24,e}te.writeUint32LE=Gr,te.writeInt32LE=Gr;function Yc(t,e){e===void 0&&(e=0);var r=Ri(t,e),i=Ri(t,e+4);return r*4294967296+i-(i>>31)*4294967296}te.readInt64BE=Yc;function Xc(t,e){e===void 0&&(e=0);var r=Li(t,e),i=Li(t,e+4);return r*4294967296+i}te.readUint64BE=Xc;function kc(t,e){e===void 0&&(e=0);var r=Pi(t,e),i=Pi(t,e+4);return i*4294967296+r-(r>>31)*4294967296}te.readInt64LE=kc;function Jc(t,e){e===void 0&&(e=0);var r=Fi(t,e),i=Fi(t,e+4);return i*4294967296+r}te.readUint64LE=Jc;function Yn(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),qr(t/4294967296>>>0,e,r),qr(t>>>0,e,r+4),e}te.writeUint64BE=Yn,te.writeInt64BE=Yn;function Xn(t,e,r){return e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0),Gr(t>>>0,e,r),Gr(t/4294967296>>>0,e,r+4),e}te.writeUint64LE=Xn,te.writeInt64LE=Xn;function Zc(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var i=0,n=1,s=t/8+r-1;s>=r;s--)i+=e[s]*n,n*=256;return i}te.readUintBE=Zc;function Qc(t,e,r){if(r===void 0&&(r=0),t%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(t/8>e.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var i=0,n=1,s=r;s<r+t/8;s++)i+=e[s]*n,n*=256;return i}te.readUintLE=Qc;function eu(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!qn.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var n=1,s=t/8+i-1;s>=i;s--)r[s]=e/n&255,n*=256;return r}te.writeUintBE=eu;function tu(t,e,r,i){if(r===void 0&&(r=new Uint8Array(t/8)),i===void 0&&(i=0),t%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!qn.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var n=1,s=i;s<i+t/8;s++)r[s]=e/n&255,n*=256;return r}te.writeUintLE=tu;function ru(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e)}te.readFloat32BE=ru;function iu(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat32(e,!0)}te.readFloat32LE=iu;function nu(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e)}te.readFloat64BE=nu;function su(t,e){e===void 0&&(e=0);var r=new DataView(t.buffer,t.byteOffset,t.byteLength);return r.getFloat64(e,!0)}te.readFloat64LE=su;function ou(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t),e}te.writeFloat32BE=ou;function au(t,e,r){e===void 0&&(e=new Uint8Array(4)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat32(r,t,!0),e}te.writeFloat32LE=au;function cu(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t),e}te.writeFloat64BE=cu;function uu(t,e,r){e===void 0&&(e=new Uint8Array(8)),r===void 0&&(r=0);var i=new DataView(e.buffer,e.byteOffset,e.byteLength);return i.setFloat64(r,t,!0),e}te.writeFloat64LE=uu,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Ni,r=te,i=dt;t.defaultRandomSource=new e.SystemRandomSource;function n(f,d){return d===void 0&&(d=t.defaultRandomSource),d.randomBytes(f)}t.randomBytes=n;function s(f){f===void 0&&(f=t.defaultRandomSource);var d=n(4,f),m=r.readUint32LE(d);return i.wipe(d),m}t.randomUint32=s;var u="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(f,d,m){if(d===void 0&&(d=u),m===void 0&&(m=t.defaultRandomSource),d.length<2)throw new Error("randomString charset is too short");if(d.length>256)throw new Error("randomString charset is too long");for(var C="",y=d.length,b=256-256%y;f>0;){for(var L=n(Math.ceil(f*256/b),m),v=0;v<L.length&&f>0;v++){var S=L[v];S<b&&(C+=d.charAt(S%y),f--)}i.wipe(L)}return C}t.randomString=c;function h(f,d,m){d===void 0&&(d=u),m===void 0&&(m=t.defaultRandomSource);var C=Math.ceil(f/(Math.log(d.length)/Math.LN2));return c(C,d,m)}t.randomStringForEntropy=h}(or);var kn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=dt;t.DIGEST_LENGTH=64,t.BLOCK_SIZE=128;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var d=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<t.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=h[d++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(d=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,h,d,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[d++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,d=this._bufferLength,m=f/536870912|0,C=f<<3,y=f%128<112?128:256;this._buffer[d]=128;for(var b=d+1;b<y-8;b++)this._buffer[b]=0;e.writeUint32BE(m,this._buffer,y-8),e.writeUint32BE(C,this._buffer,y-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,y),this._finished=!0}for(var b=0;b<this.digestLength/8;b++)e.writeUint32BE(this._stateHi[b],h,b*8),e.writeUint32BE(this._stateLo[b],h,b*8+4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._stateHi.set(h.stateHi),this._stateLo.set(h.stateLo),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.stateHi),r.wipe(h.stateLo),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA512=i;var n=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,h,f,d,m,C,y){for(var b=f[0],L=f[1],v=f[2],S=f[3],R=f[4],A=f[5],D=f[6],T=f[7],_=d[0],o=d[1],p=d[2],j=d[3],K=d[4],X=d[5],k=d[6],J=d[7],x,N,V,G,F,U,M,$;y>=128;){for(var ie=0;ie<16;ie++){var B=8*ie+C;c[ie]=e.readUint32BE(m,B),h[ie]=e.readUint32BE(m,B+4)}for(var ie=0;ie<80;ie++){var Q=b,W=L,ae=v,I=S,O=R,w=A,a=D,g=T,z=_,Y=o,fe=p,_e=j,de=K,we=X,Ue=k,Ce=J;if(x=T,N=J,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=(R>>>14|K<<32-14)^(R>>>18|K<<32-18)^(K>>>41-32|R<<32-(41-32)),N=(K>>>14|R<<32-14)^(K>>>18|R<<32-18)^(R>>>41-32|K<<32-(41-32)),F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,x=R&A^~R&D,N=K&X^~K&k,F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,x=n[ie*2],N=n[ie*2+1],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,x=c[ie%16],N=h[ie%16],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,V=M&65535|$<<16,G=F&65535|U<<16,x=V,N=G,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=(b>>>28|_<<32-28)^(_>>>34-32|b<<32-(34-32))^(_>>>39-32|b<<32-(39-32)),N=(_>>>28|b<<32-28)^(b>>>34-32|_<<32-(34-32))^(b>>>39-32|_<<32-(39-32)),F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,x=b&L^b&v^L&v,N=_&o^_&p^o&p,F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,g=M&65535|$<<16,Ce=F&65535|U<<16,x=I,N=_e,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=V,N=G,F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,I=M&65535|$<<16,_e=F&65535|U<<16,L=Q,v=W,S=ae,R=I,A=O,D=w,T=a,b=g,o=z,p=Y,j=fe,K=_e,X=de,k=we,J=Ue,_=Ce,ie%16===15)for(var B=0;B<16;B++)x=c[B],N=h[B],F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=c[(B+9)%16],N=h[(B+9)%16],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,V=c[(B+1)%16],G=h[(B+1)%16],x=(V>>>1|G<<32-1)^(V>>>8|G<<32-8)^V>>>7,N=(G>>>1|V<<32-1)^(G>>>8|V<<32-8)^(G>>>7|V<<32-7),F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,V=c[(B+14)%16],G=h[(B+14)%16],x=(V>>>19|G<<32-19)^(G>>>61-32|V<<32-(61-32))^V>>>6,N=(G>>>19|V<<32-19)^(V>>>61-32|G<<32-(61-32))^(G>>>6|V<<32-6),F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,c[B]=M&65535|$<<16,h[B]=F&65535|U<<16}x=b,N=_,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=f[0],N=d[0],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,f[0]=b=M&65535|$<<16,d[0]=_=F&65535|U<<16,x=L,N=o,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=f[1],N=d[1],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,f[1]=L=M&65535|$<<16,d[1]=o=F&65535|U<<16,x=v,N=p,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=f[2],N=d[2],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,f[2]=v=M&65535|$<<16,d[2]=p=F&65535|U<<16,x=S,N=j,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=f[3],N=d[3],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,f[3]=S=M&65535|$<<16,d[3]=j=F&65535|U<<16,x=R,N=K,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=f[4],N=d[4],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,f[4]=R=M&65535|$<<16,d[4]=K=F&65535|U<<16,x=A,N=X,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=f[5],N=d[5],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,f[5]=A=M&65535|$<<16,d[5]=X=F&65535|U<<16,x=D,N=k,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=f[6],N=d[6],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,f[6]=D=M&65535|$<<16,d[6]=k=F&65535|U<<16,x=T,N=J,F=N&65535,U=N>>>16,M=x&65535,$=x>>>16,x=f[7],N=d[7],F+=N&65535,U+=N>>>16,M+=x&65535,$+=x>>>16,U+=F>>>16,M+=U>>>16,$+=M>>>16,f[7]=T=M&65535|$<<16,d[7]=J=F&65535|U<<16,C+=128,y-=128}return C}function u(c){var h=new i;h.update(c);var f=h.digest();return h.clean(),f}t.hash=u})(kn),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=or,r=kn,i=dt;t.SIGNATURE_LENGTH=64,t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=64,t.SEED_LENGTH=32;function n(I){var O=new Float64Array(16);if(I)for(var w=0;w<I.length;w++)O[w]=I[w];return O}var s=new Uint8Array(32);s[0]=9;var u=n(),c=n([1]),h=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),d=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),C=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function y(I,O){for(var w=0;w<16;w++)I[w]=O[w]|0}function b(I){for(var O=1,w=0;w<16;w++){var a=I[w]+O+65535;O=Math.floor(a/65536),I[w]=a-O*65536}I[0]+=O-1+37*(O-1)}function L(I,O,w){for(var a=~(w-1),g=0;g<16;g++){var z=a&(I[g]^O[g]);I[g]^=z,O[g]^=z}}function v(I,O){for(var w=n(),a=n(),g=0;g<16;g++)a[g]=O[g];b(a),b(a),b(a);for(var z=0;z<2;z++){w[0]=a[0]-65517;for(var g=1;g<15;g++)w[g]=a[g]-65535-(w[g-1]>>16&1),w[g-1]&=65535;w[15]=a[15]-32767-(w[14]>>16&1);var Y=w[15]>>16&1;w[14]&=65535,L(a,w,1-Y)}for(var g=0;g<16;g++)I[2*g]=a[g]&255,I[2*g+1]=a[g]>>8}function S(I,O){for(var w=0,a=0;a<32;a++)w|=I[a]^O[a];return(1&w-1>>>8)-1}function R(I,O){var w=new Uint8Array(32),a=new Uint8Array(32);return v(w,I),v(a,O),S(w,a)}function A(I){var O=new Uint8Array(32);return v(O,I),O[0]&1}function D(I,O){for(var w=0;w<16;w++)I[w]=O[2*w]+(O[2*w+1]<<8);I[15]&=32767}function T(I,O,w){for(var a=0;a<16;a++)I[a]=O[a]+w[a]}function _(I,O,w){for(var a=0;a<16;a++)I[a]=O[a]-w[a]}function o(I,O,w){var a,g,z=0,Y=0,fe=0,_e=0,de=0,we=0,Ue=0,Ce=0,ve=0,pe=0,le=0,ue=0,ce=0,oe=0,se=0,ee=0,he=0,ge=0,re=0,ye=0,be=0,De=0,Se=0,Ee=0,Dt=0,At=0,$t=0,pt=0,kt=0,Pr=0,si=0,Me=w[0],Re=w[1],je=w[2],$e=w[3],ze=w[4],Le=w[5],Ge=w[6],We=w[7],Ye=w[8],Xe=w[9],ke=w[10],Ke=w[11],Be=w[12],Ne=w[13],Je=w[14],Ze=w[15];a=O[0],z+=a*Me,Y+=a*Re,fe+=a*je,_e+=a*$e,de+=a*ze,we+=a*Le,Ue+=a*Ge,Ce+=a*We,ve+=a*Ye,pe+=a*Xe,le+=a*ke,ue+=a*Ke,ce+=a*Be,oe+=a*Ne,se+=a*Je,ee+=a*Ze,a=O[1],Y+=a*Me,fe+=a*Re,_e+=a*je,de+=a*$e,we+=a*ze,Ue+=a*Le,Ce+=a*Ge,ve+=a*We,pe+=a*Ye,le+=a*Xe,ue+=a*ke,ce+=a*Ke,oe+=a*Be,se+=a*Ne,ee+=a*Je,he+=a*Ze,a=O[2],fe+=a*Me,_e+=a*Re,de+=a*je,we+=a*$e,Ue+=a*ze,Ce+=a*Le,ve+=a*Ge,pe+=a*We,le+=a*Ye,ue+=a*Xe,ce+=a*ke,oe+=a*Ke,se+=a*Be,ee+=a*Ne,he+=a*Je,ge+=a*Ze,a=O[3],_e+=a*Me,de+=a*Re,we+=a*je,Ue+=a*$e,Ce+=a*ze,ve+=a*Le,pe+=a*Ge,le+=a*We,ue+=a*Ye,ce+=a*Xe,oe+=a*ke,se+=a*Ke,ee+=a*Be,he+=a*Ne,ge+=a*Je,re+=a*Ze,a=O[4],de+=a*Me,we+=a*Re,Ue+=a*je,Ce+=a*$e,ve+=a*ze,pe+=a*Le,le+=a*Ge,ue+=a*We,ce+=a*Ye,oe+=a*Xe,se+=a*ke,ee+=a*Ke,he+=a*Be,ge+=a*Ne,re+=a*Je,ye+=a*Ze,a=O[5],we+=a*Me,Ue+=a*Re,Ce+=a*je,ve+=a*$e,pe+=a*ze,le+=a*Le,ue+=a*Ge,ce+=a*We,oe+=a*Ye,se+=a*Xe,ee+=a*ke,he+=a*Ke,ge+=a*Be,re+=a*Ne,ye+=a*Je,be+=a*Ze,a=O[6],Ue+=a*Me,Ce+=a*Re,ve+=a*je,pe+=a*$e,le+=a*ze,ue+=a*Le,ce+=a*Ge,oe+=a*We,se+=a*Ye,ee+=a*Xe,he+=a*ke,ge+=a*Ke,re+=a*Be,ye+=a*Ne,be+=a*Je,De+=a*Ze,a=O[7],Ce+=a*Me,ve+=a*Re,pe+=a*je,le+=a*$e,ue+=a*ze,ce+=a*Le,oe+=a*Ge,se+=a*We,ee+=a*Ye,he+=a*Xe,ge+=a*ke,re+=a*Ke,ye+=a*Be,be+=a*Ne,De+=a*Je,Se+=a*Ze,a=O[8],ve+=a*Me,pe+=a*Re,le+=a*je,ue+=a*$e,ce+=a*ze,oe+=a*Le,se+=a*Ge,ee+=a*We,he+=a*Ye,ge+=a*Xe,re+=a*ke,ye+=a*Ke,be+=a*Be,De+=a*Ne,Se+=a*Je,Ee+=a*Ze,a=O[9],pe+=a*Me,le+=a*Re,ue+=a*je,ce+=a*$e,oe+=a*ze,se+=a*Le,ee+=a*Ge,he+=a*We,ge+=a*Ye,re+=a*Xe,ye+=a*ke,be+=a*Ke,De+=a*Be,Se+=a*Ne,Ee+=a*Je,Dt+=a*Ze,a=O[10],le+=a*Me,ue+=a*Re,ce+=a*je,oe+=a*$e,se+=a*ze,ee+=a*Le,he+=a*Ge,ge+=a*We,re+=a*Ye,ye+=a*Xe,be+=a*ke,De+=a*Ke,Se+=a*Be,Ee+=a*Ne,Dt+=a*Je,At+=a*Ze,a=O[11],ue+=a*Me,ce+=a*Re,oe+=a*je,se+=a*$e,ee+=a*ze,he+=a*Le,ge+=a*Ge,re+=a*We,ye+=a*Ye,be+=a*Xe,De+=a*ke,Se+=a*Ke,Ee+=a*Be,Dt+=a*Ne,At+=a*Je,$t+=a*Ze,a=O[12],ce+=a*Me,oe+=a*Re,se+=a*je,ee+=a*$e,he+=a*ze,ge+=a*Le,re+=a*Ge,ye+=a*We,be+=a*Ye,De+=a*Xe,Se+=a*ke,Ee+=a*Ke,Dt+=a*Be,At+=a*Ne,$t+=a*Je,pt+=a*Ze,a=O[13],oe+=a*Me,se+=a*Re,ee+=a*je,he+=a*$e,ge+=a*ze,re+=a*Le,ye+=a*Ge,be+=a*We,De+=a*Ye,Se+=a*Xe,Ee+=a*ke,Dt+=a*Ke,At+=a*Be,$t+=a*Ne,pt+=a*Je,kt+=a*Ze,a=O[14],se+=a*Me,ee+=a*Re,he+=a*je,ge+=a*$e,re+=a*ze,ye+=a*Le,be+=a*Ge,De+=a*We,Se+=a*Ye,Ee+=a*Xe,Dt+=a*ke,At+=a*Ke,$t+=a*Be,pt+=a*Ne,kt+=a*Je,Pr+=a*Ze,a=O[15],ee+=a*Me,he+=a*Re,ge+=a*je,re+=a*$e,ye+=a*ze,be+=a*Le,De+=a*Ge,Se+=a*We,Ee+=a*Ye,Dt+=a*Xe,At+=a*ke,$t+=a*Ke,pt+=a*Be,kt+=a*Ne,Pr+=a*Je,si+=a*Ze,z+=38*he,Y+=38*ge,fe+=38*re,_e+=38*ye,de+=38*be,we+=38*De,Ue+=38*Se,Ce+=38*Ee,ve+=38*Dt,pe+=38*At,le+=38*$t,ue+=38*pt,ce+=38*kt,oe+=38*Pr,se+=38*si,g=1,a=z+g+65535,g=Math.floor(a/65536),z=a-g*65536,a=Y+g+65535,g=Math.floor(a/65536),Y=a-g*65536,a=fe+g+65535,g=Math.floor(a/65536),fe=a-g*65536,a=_e+g+65535,g=Math.floor(a/65536),_e=a-g*65536,a=de+g+65535,g=Math.floor(a/65536),de=a-g*65536,a=we+g+65535,g=Math.floor(a/65536),we=a-g*65536,a=Ue+g+65535,g=Math.floor(a/65536),Ue=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=ve+g+65535,g=Math.floor(a/65536),ve=a-g*65536,a=pe+g+65535,g=Math.floor(a/65536),pe=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=ue+g+65535,g=Math.floor(a/65536),ue=a-g*65536,a=ce+g+65535,g=Math.floor(a/65536),ce=a-g*65536,a=oe+g+65535,g=Math.floor(a/65536),oe=a-g*65536,a=se+g+65535,g=Math.floor(a/65536),se=a-g*65536,a=ee+g+65535,g=Math.floor(a/65536),ee=a-g*65536,z+=g-1+37*(g-1),g=1,a=z+g+65535,g=Math.floor(a/65536),z=a-g*65536,a=Y+g+65535,g=Math.floor(a/65536),Y=a-g*65536,a=fe+g+65535,g=Math.floor(a/65536),fe=a-g*65536,a=_e+g+65535,g=Math.floor(a/65536),_e=a-g*65536,a=de+g+65535,g=Math.floor(a/65536),de=a-g*65536,a=we+g+65535,g=Math.floor(a/65536),we=a-g*65536,a=Ue+g+65535,g=Math.floor(a/65536),Ue=a-g*65536,a=Ce+g+65535,g=Math.floor(a/65536),Ce=a-g*65536,a=ve+g+65535,g=Math.floor(a/65536),ve=a-g*65536,a=pe+g+65535,g=Math.floor(a/65536),pe=a-g*65536,a=le+g+65535,g=Math.floor(a/65536),le=a-g*65536,a=ue+g+65535,g=Math.floor(a/65536),ue=a-g*65536,a=ce+g+65535,g=Math.floor(a/65536),ce=a-g*65536,a=oe+g+65535,g=Math.floor(a/65536),oe=a-g*65536,a=se+g+65535,g=Math.floor(a/65536),se=a-g*65536,a=ee+g+65535,g=Math.floor(a/65536),ee=a-g*65536,z+=g-1+37*(g-1),I[0]=z,I[1]=Y,I[2]=fe,I[3]=_e,I[4]=de,I[5]=we,I[6]=Ue,I[7]=Ce,I[8]=ve,I[9]=pe,I[10]=le,I[11]=ue,I[12]=ce,I[13]=oe,I[14]=se,I[15]=ee}function p(I,O){o(I,O,O)}function j(I,O){var w=n(),a;for(a=0;a<16;a++)w[a]=O[a];for(a=253;a>=0;a--)p(w,w),a!==2&&a!==4&&o(w,w,O);for(a=0;a<16;a++)I[a]=w[a]}function K(I,O){var w=n(),a;for(a=0;a<16;a++)w[a]=O[a];for(a=250;a>=0;a--)p(w,w),a!==1&&o(w,w,O);for(a=0;a<16;a++)I[a]=w[a]}function X(I,O){var w=n(),a=n(),g=n(),z=n(),Y=n(),fe=n(),_e=n(),de=n(),we=n();_(w,I[1],I[0]),_(we,O[1],O[0]),o(w,w,we),T(a,I[0],I[1]),T(we,O[0],O[1]),o(a,a,we),o(g,I[3],O[3]),o(g,g,f),o(z,I[2],O[2]),T(z,z,z),_(Y,a,w),_(fe,z,g),T(_e,z,g),T(de,a,w),o(I[0],Y,fe),o(I[1],de,_e),o(I[2],_e,fe),o(I[3],Y,de)}function k(I,O,w){for(var a=0;a<4;a++)L(I[a],O[a],w)}function J(I,O){var w=n(),a=n(),g=n();j(g,O[2]),o(w,O[0],g),o(a,O[1],g),v(I,a),I[31]^=A(w)<<7}function x(I,O,w){y(I[0],u),y(I[1],c),y(I[2],c),y(I[3],u);for(var a=255;a>=0;--a){var g=w[a/8|0]>>(a&7)&1;k(I,O,g),X(O,I),X(I,I),k(I,O,g)}}function N(I,O){var w=[n(),n(),n(),n()];y(w[0],d),y(w[1],m),y(w[2],c),o(w[3],d,m),x(I,w,O)}function V(I){if(I.length!==t.SEED_LENGTH)throw new Error("ed25519: seed must be "+t.SEED_LENGTH+" bytes");var O=r.hash(I);O[0]&=248,O[31]&=127,O[31]|=64;var w=new Uint8Array(32),a=[n(),n(),n(),n()];N(a,O),J(w,a);var g=new Uint8Array(64);return g.set(I),g.set(w,32),{publicKey:w,secretKey:g}}t.generateKeyPairFromSeed=V;function G(I){var O=e.randomBytes(32,I),w=V(O);return i.wipe(O),w}t.generateKeyPair=G;function F(I){if(I.length!==t.SECRET_KEY_LENGTH)throw new Error("ed25519: secret key must be "+t.SECRET_KEY_LENGTH+" bytes");return new Uint8Array(I.subarray(32))}t.extractPublicKeyFromSecretKey=F;var U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function M(I,O){var w,a,g,z;for(a=63;a>=32;--a){for(w=0,g=a-32,z=a-12;g<z;++g)O[g]+=w-16*O[a]*U[g-(a-32)],w=Math.floor((O[g]+128)/256),O[g]-=w*256;O[g]+=w,O[a]=0}for(w=0,g=0;g<32;g++)O[g]+=w-(O[31]>>4)*U[g],w=O[g]>>8,O[g]&=255;for(g=0;g<32;g++)O[g]-=w*U[g];for(a=0;a<32;a++)O[a+1]+=O[a]>>8,I[a]=O[a]&255}function $(I){for(var O=new Float64Array(64),w=0;w<64;w++)O[w]=I[w];for(var w=0;w<64;w++)I[w]=0;M(I,O)}function ie(I,O){var w=new Float64Array(64),a=[n(),n(),n(),n()],g=r.hash(I.subarray(0,32));g[0]&=248,g[31]&=127,g[31]|=64;var z=new Uint8Array(64);z.set(g.subarray(32),32);var Y=new r.SHA512;Y.update(z.subarray(32)),Y.update(O);var fe=Y.digest();Y.clean(),$(fe),N(a,fe),J(z,a),Y.reset(),Y.update(z.subarray(0,32)),Y.update(I.subarray(32)),Y.update(O);var _e=Y.digest();$(_e);for(var de=0;de<32;de++)w[de]=fe[de];for(var de=0;de<32;de++)for(var we=0;we<32;we++)w[de+we]+=_e[de]*g[we];return M(z.subarray(32),w),z}t.sign=ie;function B(I,O){var w=n(),a=n(),g=n(),z=n(),Y=n(),fe=n(),_e=n();return y(I[2],c),D(I[1],O),p(g,I[1]),o(z,g,h),_(g,g,I[2]),T(z,I[2],z),p(Y,z),p(fe,Y),o(_e,fe,Y),o(w,_e,g),o(w,w,z),K(w,w),o(w,w,g),o(w,w,z),o(w,w,z),o(I[0],w,z),p(a,I[0]),o(a,a,z),R(a,g)&&o(I[0],I[0],C),p(a,I[0]),o(a,a,z),R(a,g)?-1:(A(I[0])===O[31]>>7&&_(I[0],u,I[0]),o(I[3],I[0],I[1]),0)}function Q(I,O,w){var a=new Uint8Array(32),g=[n(),n(),n(),n()],z=[n(),n(),n(),n()];if(w.length!==t.SIGNATURE_LENGTH)throw new Error("ed25519: signature must be "+t.SIGNATURE_LENGTH+" bytes");if(B(z,I))return!1;var Y=new r.SHA512;Y.update(w.subarray(0,32)),Y.update(I),Y.update(O);var fe=Y.digest();return $(fe),x(g,z,fe),N(z,w.subarray(32)),X(g,z),J(a,g),!S(w,a)}t.verify=Q;function W(I){var O=[n(),n(),n(),n()];if(B(O,I))throw new Error("Ed25519: invalid public key");var w=n(),a=n(),g=O[1];T(w,c,g),_(a,c,g),j(a,a),o(w,w,a);var z=new Uint8Array(32);return v(z,w),z}t.convertPublicKeyToX25519=W;function ae(I){var O=r.hash(I.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;var w=new Uint8Array(O.subarray(0,32));return i.wipe(O),w}t.convertSecretKeyToX25519=ae}(Ai);const hu="EdDSA",fu="JWT",Jn=".",Zn="base64url",lu="utf8",du="utf8",pu=":",gu="did",vu="key",Qn="base58btc",_u="z",yu="K36",bu=32;function Ui(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=new Uint8Array(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function wu(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),u=s.charCodeAt(0);if(r[u]!==255)throw new TypeError(s+" is ambiguous");r[u]=n}var c=t.length,h=t.charAt(0),f=Math.log(c)/Math.log(256),d=Math.log(256)/Math.log(c);function m(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(b.length===0)return"";for(var L=0,v=0,S=0,R=b.length;S!==R&&b[S]===0;)S++,L++;for(var A=(R-S)*d+1>>>0,D=new Uint8Array(A);S!==R;){for(var T=b[S],_=0,o=A-1;(T!==0||_<v)&&o!==-1;o--,_++)T+=256*D[o]>>>0,D[o]=T%c>>>0,T=T/c>>>0;if(T!==0)throw new Error("Non-zero carry");v=_,S++}for(var p=A-v;p!==A&&D[p]===0;)p++;for(var j=h.repeat(L);p<A;++p)j+=t.charAt(D[p]);return j}function C(b){if(typeof b!="string")throw new TypeError("Expected String");if(b.length===0)return new Uint8Array;var L=0;if(b[L]!==" "){for(var v=0,S=0;b[L]===h;)v++,L++;for(var R=(b.length-L)*f+1>>>0,A=new Uint8Array(R);b[L];){var D=r[b.charCodeAt(L)];if(D===255)return;for(var T=0,_=R-1;(D!==0||T<S)&&_!==-1;_--,T++)D+=c*A[_]>>>0,A[_]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");S=T,L++}if(b[L]!==" "){for(var o=R-S;o!==R&&A[o]===0;)o++;for(var p=new Uint8Array(v+(R-o)),j=v;o!==R;)p[j++]=A[o++];return p}}}function y(b){var L=C(b);if(L)return L;throw new Error(`Non-${e} character`)}return{encode:m,decodeUnsafe:C,decode:y}}var Eu=wu,mu=Eu;const es=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},Du=t=>new TextEncoder().encode(t),Su=t=>new TextDecoder().decode(t);class xu{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ou{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ts(this,e)}}class Iu{constructor(e){this.decoders=e}or(e){return ts(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ts=(t,e)=>new Iu({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});class Au{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new xu(e,r,i),this.decoder=new Ou(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Wr=({name:t,prefix:e,encode:r,decode:i})=>new Au(t,e,r,i),mr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=mu(r,e);return Wr({prefix:t,name:e,encode:i,decode:s=>es(n(s))})},Nu=(t,e,r,i)=>{const n={};for(let d=0;d<e.length;++d)n[e[d]]=d;let s=t.length;for(;t[s-1]==="=";)--s;const u=new Uint8Array(s*r/8|0);let c=0,h=0,f=0;for(let d=0;d<s;++d){const m=n[t[d]];if(m===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|m,c+=r,c>=8&&(c-=8,u[f++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return u},Tu=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",u=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],u+=8;u>r;)u-=r,s+=e[n&c>>u];if(u&&(s+=e[n&c<<r-u]),i)for(;s.length*r&7;)s+="=";return s},et=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Wr({prefix:e,name:t,encode(n){return Tu(n,i,r)},decode(n){return Nu(n,i,r,t)}}),Cu=Wr({prefix:"\0",name:"identity",encode:t=>Su(t),decode:t=>Du(t)});var Ru=Object.freeze({__proto__:null,identity:Cu});const Lu=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Pu=Object.freeze({__proto__:null,base2:Lu});const Fu=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Uu=Object.freeze({__proto__:null,base8:Fu});const Mu=mr({prefix:"9",name:"base10",alphabet:"0123456789"});var ju=Object.freeze({__proto__:null,base10:Mu});const $u=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),zu=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Bu=Object.freeze({__proto__:null,base16:$u,base16upper:zu});const Ku=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Hu=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Vu=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qu=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Gu=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Wu=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Yu=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Xu=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ku=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ju=Object.freeze({__proto__:null,base32:Ku,base32upper:Hu,base32pad:Vu,base32padupper:qu,base32hex:Gu,base32hexupper:Wu,base32hexpad:Yu,base32hexpadupper:Xu,base32z:ku});const Zu=mr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Qu=mr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var eh=Object.freeze({__proto__:null,base36:Zu,base36upper:Qu});const th=mr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),rh=mr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ih=Object.freeze({__proto__:null,base58btc:th,base58flickr:rh});const nh=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sh=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),oh=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ah=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ch=Object.freeze({__proto__:null,base64:nh,base64pad:sh,base64url:oh,base64urlpad:ah});const rs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),uh=rs.reduce((t,e,r)=>(t[r]=e,t),[]),hh=rs.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function fh(t){return t.reduce((e,r)=>(e+=uh[r],e),"")}function lh(t){const e=[];for(const r of t){const i=hh[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const dh=Wr({prefix:"\u{1F680}",name:"base256emoji",encode:fh,decode:lh});var ph=Object.freeze({__proto__:null,base256emoji:dh}),gh=ns,is=128,vh=127,_h=~vh,yh=Math.pow(2,31);function ns(t,e,r){e=e||[],r=r||0;for(var i=r;t>=yh;)e[r++]=t&255|is,t/=128;for(;t&_h;)e[r++]=t&255|is,t>>>=7;return e[r]=t|0,ns.bytes=r-i+1,e}var bh=Mi,wh=128,ss=127;function Mi(t,i){var r=0,i=i||0,n=0,s=i,u,c=t.length;do{if(s>=c)throw Mi.bytes=0,new RangeError("Could not decode varint");u=t[s++],r+=n<28?(u&ss)<<n:(u&ss)*Math.pow(2,n),n+=7}while(u>=wh);return Mi.bytes=s-i,r}var Eh=Math.pow(2,7),mh=Math.pow(2,14),Dh=Math.pow(2,21),Sh=Math.pow(2,28),xh=Math.pow(2,35),Oh=Math.pow(2,42),Ih=Math.pow(2,49),Ah=Math.pow(2,56),Nh=Math.pow(2,63),Th=function(t){return t<Eh?1:t<mh?2:t<Dh?3:t<Sh?4:t<xh?5:t<Oh?6:t<Ih?7:t<Ah?8:t<Nh?9:10},Ch={encode:gh,decode:bh,encodingLength:Th},os=Ch;const as=(t,e,r=0)=>(os.encode(t,e,r),e),cs=t=>os.encodingLength(t),ji=(t,e)=>{const r=e.byteLength,i=cs(t),n=i+cs(r),s=new Uint8Array(n+r);return as(t,s,0),as(r,s,i),s.set(e,n),new Rh(t,r,e,s)};class Rh{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const us=({name:t,code:e,encode:r})=>new Lh(t,e,r);class Lh{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?ji(this.code,r):r.then(i=>ji(this.code,i))}else throw Error("Unknown type, must be binary type")}}const hs=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Ph=us({name:"sha2-256",code:18,encode:hs("SHA-256")}),Fh=us({name:"sha2-512",code:19,encode:hs("SHA-512")});var Uh=Object.freeze({__proto__:null,sha256:Ph,sha512:Fh});const fs=0,Mh="identity",ls=es;var jh=Object.freeze({__proto__:null,identity:{code:fs,name:Mh,encode:ls,digest:t=>ji(fs,ls(t))}});new TextEncoder,new TextDecoder;const ds={...Ru,...Pu,...Uu,...ju,...Bu,...Ju,...eh,...ih,...ch,...ph};({...Uh,...jh});function ps(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const gs=ps("utf8","u",t=>{const e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),$i=ps("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),vs={utf8:gs,"utf-8":gs,hex:ds.base16,latin1:$i,ascii:$i,binary:$i,...ds};function ut(t,e="utf8"){const r=vs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}function ht(t,e="utf8"){const r=vs[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}function Yr(t){return ut(ht(Ii(t),lu),Zn)}function _s(t){const e=ht(yu,Qn),r=_u+ut(Ui([e,t]),Qn);return[gu,vu,r].join(pu)}function $h(t){return ut(t,Zn)}function zh(t){return ht([Yr(t.header),Yr(t.payload)].join(Jn),du)}function Bh(t){return[Yr(t.header),Yr(t.payload),$h(t.signature)].join(Jn)}function ys(t=or.randomBytes(bu)){return Ai.generateKeyPairFromSeed(t)}async function Kh(t,e,r,i,n=Ie.fromMiliseconds(Date.now())){const s={alg:hu,typ:fu},u=_s(i.publicKey),c=n+r,h={iss:u,sub:t,aud:e,iat:n,exp:c},f=zh({header:s,payload:h}),d=Ai.sign(i.secretKey,f);return Bh({header:s,payload:h,signature:d})}var zi={},Xr={};Object.defineProperty(Xr,"__esModule",{value:!0});var it=te,Bi=dt,Hh=20;function Vh(t,e,r){for(var i=1634760805,n=857760878,s=2036477234,u=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],h=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],d=r[15]<<24|r[14]<<16|r[13]<<8|r[12],m=r[19]<<24|r[18]<<16|r[17]<<8|r[16],C=r[23]<<24|r[22]<<16|r[21]<<8|r[20],y=r[27]<<24|r[26]<<16|r[25]<<8|r[24],b=r[31]<<24|r[30]<<16|r[29]<<8|r[28],L=e[3]<<24|e[2]<<16|e[1]<<8|e[0],v=e[7]<<24|e[6]<<16|e[5]<<8|e[4],S=e[11]<<24|e[10]<<16|e[9]<<8|e[8],R=e[15]<<24|e[14]<<16|e[13]<<8|e[12],A=i,D=n,T=s,_=u,o=c,p=h,j=f,K=d,X=m,k=C,J=y,x=b,N=L,V=v,G=S,F=R,U=0;U<Hh;U+=2)A=A+o|0,N^=A,N=N>>>32-16|N<<16,X=X+N|0,o^=X,o=o>>>32-12|o<<12,D=D+p|0,V^=D,V=V>>>32-16|V<<16,k=k+V|0,p^=k,p=p>>>32-12|p<<12,T=T+j|0,G^=T,G=G>>>32-16|G<<16,J=J+G|0,j^=J,j=j>>>32-12|j<<12,_=_+K|0,F^=_,F=F>>>32-16|F<<16,x=x+F|0,K^=x,K=K>>>32-12|K<<12,T=T+j|0,G^=T,G=G>>>32-8|G<<8,J=J+G|0,j^=J,j=j>>>32-7|j<<7,_=_+K|0,F^=_,F=F>>>32-8|F<<8,x=x+F|0,K^=x,K=K>>>32-7|K<<7,D=D+p|0,V^=D,V=V>>>32-8|V<<8,k=k+V|0,p^=k,p=p>>>32-7|p<<7,A=A+o|0,N^=A,N=N>>>32-8|N<<8,X=X+N|0,o^=X,o=o>>>32-7|o<<7,A=A+p|0,F^=A,F=F>>>32-16|F<<16,J=J+F|0,p^=J,p=p>>>32-12|p<<12,D=D+j|0,N^=D,N=N>>>32-16|N<<16,x=x+N|0,j^=x,j=j>>>32-12|j<<12,T=T+K|0,V^=T,V=V>>>32-16|V<<16,X=X+V|0,K^=X,K=K>>>32-12|K<<12,_=_+o|0,G^=_,G=G>>>32-16|G<<16,k=k+G|0,o^=k,o=o>>>32-12|o<<12,T=T+K|0,V^=T,V=V>>>32-8|V<<8,X=X+V|0,K^=X,K=K>>>32-7|K<<7,_=_+o|0,G^=_,G=G>>>32-8|G<<8,k=k+G|0,o^=k,o=o>>>32-7|o<<7,D=D+j|0,N^=D,N=N>>>32-8|N<<8,x=x+N|0,j^=x,j=j>>>32-7|j<<7,A=A+p|0,F^=A,F=F>>>32-8|F<<8,J=J+F|0,p^=J,p=p>>>32-7|p<<7;it.writeUint32LE(A+i|0,t,0),it.writeUint32LE(D+n|0,t,4),it.writeUint32LE(T+s|0,t,8),it.writeUint32LE(_+u|0,t,12),it.writeUint32LE(o+c|0,t,16),it.writeUint32LE(p+h|0,t,20),it.writeUint32LE(j+f|0,t,24),it.writeUint32LE(K+d|0,t,28),it.writeUint32LE(X+m|0,t,32),it.writeUint32LE(k+C|0,t,36),it.writeUint32LE(J+y|0,t,40),it.writeUint32LE(x+b|0,t,44),it.writeUint32LE(N+L|0,t,48),it.writeUint32LE(V+v|0,t,52),it.writeUint32LE(G+S|0,t,56),it.writeUint32LE(F+R|0,t,60)}function bs(t,e,r,i,n){if(n===void 0&&(n=0),t.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,u;if(n===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),u=s.length-e.length,s.set(e,u)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=e,u=n}for(var c=new Uint8Array(64),h=0;h<r.length;h+=64){Vh(c,s,t);for(var f=h;f<h+64&&f<r.length;f++)i[f]=r[f]^c[f-h];Gh(s,0,u)}return Bi.wipe(c),n===0&&Bi.wipe(s),i}Xr.streamXOR=bs;function qh(t,e,r,i){return i===void 0&&(i=0),Bi.wipe(r),bs(t,e,r,r,i)}Xr.stream=qh;function Gh(t,e,r){for(var i=1;r--;)i=i+(t[e]&255)|0,t[e]=i&255,i>>>=8,e++;if(i>0)throw new Error("ChaCha: counter overflow")}var ws={},Ft={};Object.defineProperty(Ft,"__esModule",{value:!0});function Wh(t,e,r){return~(t-1)&e|t-1&r}Ft.select=Wh;function Yh(t,e){return(t|0)-(e|0)-1>>>31&1}Ft.lessOrEqual=Yh;function Es(t,e){if(t.length!==e.length)return 0;for(var r=0,i=0;i<t.length;i++)r|=t[i]^e[i];return 1&r-1>>>8}Ft.compare=Es;function Xh(t,e){return t.length===0||e.length===0?!1:Es(t,e)!==0}Ft.equal=Xh,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Ft,r=dt;t.DIGEST_LENGTH=16;var i=function(){function u(c){this.digestLength=t.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var h=c[0]|c[1]<<8;this._r[0]=h&8191;var f=c[2]|c[3]<<8;this._r[1]=(h>>>13|f<<3)&8191;var d=c[4]|c[5]<<8;this._r[2]=(f>>>10|d<<6)&7939;var m=c[6]|c[7]<<8;this._r[3]=(d>>>7|m<<9)&8191;var C=c[8]|c[9]<<8;this._r[4]=(m>>>4|C<<12)&255,this._r[5]=C>>>1&8190;var y=c[10]|c[11]<<8;this._r[6]=(C>>>14|y<<2)&8191;var b=c[12]|c[13]<<8;this._r[7]=(y>>>11|b<<5)&8065;var L=c[14]|c[15]<<8;this._r[8]=(b>>>8|L<<8)&8191,this._r[9]=L>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return u.prototype._blocks=function(c,h,f){for(var d=this._fin?0:2048,m=this._h[0],C=this._h[1],y=this._h[2],b=this._h[3],L=this._h[4],v=this._h[5],S=this._h[6],R=this._h[7],A=this._h[8],D=this._h[9],T=this._r[0],_=this._r[1],o=this._r[2],p=this._r[3],j=this._r[4],K=this._r[5],X=this._r[6],k=this._r[7],J=this._r[8],x=this._r[9];f>=16;){var N=c[h+0]|c[h+1]<<8;m+=N&8191;var V=c[h+2]|c[h+3]<<8;C+=(N>>>13|V<<3)&8191;var G=c[h+4]|c[h+5]<<8;y+=(V>>>10|G<<6)&8191;var F=c[h+6]|c[h+7]<<8;b+=(G>>>7|F<<9)&8191;var U=c[h+8]|c[h+9]<<8;L+=(F>>>4|U<<12)&8191,v+=U>>>1&8191;var M=c[h+10]|c[h+11]<<8;S+=(U>>>14|M<<2)&8191;var $=c[h+12]|c[h+13]<<8;R+=(M>>>11|$<<5)&8191;var ie=c[h+14]|c[h+15]<<8;A+=($>>>8|ie<<8)&8191,D+=ie>>>5|d;var B=0,Q=B;Q+=m*T,Q+=C*(5*x),Q+=y*(5*J),Q+=b*(5*k),Q+=L*(5*X),B=Q>>>13,Q&=8191,Q+=v*(5*K),Q+=S*(5*j),Q+=R*(5*p),Q+=A*(5*o),Q+=D*(5*_),B+=Q>>>13,Q&=8191;var W=B;W+=m*_,W+=C*T,W+=y*(5*x),W+=b*(5*J),W+=L*(5*k),B=W>>>13,W&=8191,W+=v*(5*X),W+=S*(5*K),W+=R*(5*j),W+=A*(5*p),W+=D*(5*o),B+=W>>>13,W&=8191;var ae=B;ae+=m*o,ae+=C*_,ae+=y*T,ae+=b*(5*x),ae+=L*(5*J),B=ae>>>13,ae&=8191,ae+=v*(5*k),ae+=S*(5*X),ae+=R*(5*K),ae+=A*(5*j),ae+=D*(5*p),B+=ae>>>13,ae&=8191;var I=B;I+=m*p,I+=C*o,I+=y*_,I+=b*T,I+=L*(5*x),B=I>>>13,I&=8191,I+=v*(5*J),I+=S*(5*k),I+=R*(5*X),I+=A*(5*K),I+=D*(5*j),B+=I>>>13,I&=8191;var O=B;O+=m*j,O+=C*p,O+=y*o,O+=b*_,O+=L*T,B=O>>>13,O&=8191,O+=v*(5*x),O+=S*(5*J),O+=R*(5*k),O+=A*(5*X),O+=D*(5*K),B+=O>>>13,O&=8191;var w=B;w+=m*K,w+=C*j,w+=y*p,w+=b*o,w+=L*_,B=w>>>13,w&=8191,w+=v*T,w+=S*(5*x),w+=R*(5*J),w+=A*(5*k),w+=D*(5*X),B+=w>>>13,w&=8191;var a=B;a+=m*X,a+=C*K,a+=y*j,a+=b*p,a+=L*o,B=a>>>13,a&=8191,a+=v*_,a+=S*T,a+=R*(5*x),a+=A*(5*J),a+=D*(5*k),B+=a>>>13,a&=8191;var g=B;g+=m*k,g+=C*X,g+=y*K,g+=b*j,g+=L*p,B=g>>>13,g&=8191,g+=v*o,g+=S*_,g+=R*T,g+=A*(5*x),g+=D*(5*J),B+=g>>>13,g&=8191;var z=B;z+=m*J,z+=C*k,z+=y*X,z+=b*K,z+=L*j,B=z>>>13,z&=8191,z+=v*p,z+=S*o,z+=R*_,z+=A*T,z+=D*(5*x),B+=z>>>13,z&=8191;var Y=B;Y+=m*x,Y+=C*J,Y+=y*k,Y+=b*X,Y+=L*K,B=Y>>>13,Y&=8191,Y+=v*j,Y+=S*p,Y+=R*o,Y+=A*_,Y+=D*T,B+=Y>>>13,Y&=8191,B=(B<<2)+B|0,B=B+Q|0,Q=B&8191,B=B>>>13,W+=B,m=Q,C=W,y=ae,b=I,L=O,v=w,S=a,R=g,A=z,D=Y,h+=16,f-=16}this._h[0]=m,this._h[1]=C,this._h[2]=y,this._h[3]=b,this._h[4]=L,this._h[5]=v,this._h[6]=S,this._h[7]=R,this._h[8]=A,this._h[9]=D},u.prototype.finish=function(c,h){h===void 0&&(h=0);var f=new Uint16Array(10),d,m,C,y;if(this._leftover){for(y=this._leftover,this._buffer[y++]=1;y<16;y++)this._buffer[y]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(d=this._h[1]>>>13,this._h[1]&=8191,y=2;y<10;y++)this._h[y]+=d,d=this._h[y]>>>13,this._h[y]&=8191;for(this._h[0]+=d*5,d=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=d,d=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=d,f[0]=this._h[0]+5,d=f[0]>>>13,f[0]&=8191,y=1;y<10;y++)f[y]=this._h[y]+d,d=f[y]>>>13,f[y]&=8191;for(f[9]-=1<<13,m=(d^1)-1,y=0;y<10;y++)f[y]&=m;for(m=~m,y=0;y<10;y++)this._h[y]=this._h[y]&m|f[y];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,C=this._h[0]+this._pad[0],this._h[0]=C&65535,y=1;y<8;y++)C=(this._h[y]+this._pad[y]|0)+(C>>>16)|0,this._h[y]=C&65535;return c[h+0]=this._h[0]>>>0,c[h+1]=this._h[0]>>>8,c[h+2]=this._h[1]>>>0,c[h+3]=this._h[1]>>>8,c[h+4]=this._h[2]>>>0,c[h+5]=this._h[2]>>>8,c[h+6]=this._h[3]>>>0,c[h+7]=this._h[3]>>>8,c[h+8]=this._h[4]>>>0,c[h+9]=this._h[4]>>>8,c[h+10]=this._h[5]>>>0,c[h+11]=this._h[5]>>>8,c[h+12]=this._h[6]>>>0,c[h+13]=this._h[6]>>>8,c[h+14]=this._h[7]>>>0,c[h+15]=this._h[7]>>>8,this._finished=!0,this},u.prototype.update=function(c){var h=0,f=c.length,d;if(this._leftover){d=16-this._leftover,d>f&&(d=f);for(var m=0;m<d;m++)this._buffer[this._leftover+m]=c[h+m];if(f-=d,h+=d,this._leftover+=d,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(d=f-f%16,this._blocks(c,h,d),h+=d,f-=d),f){for(var m=0;m<f;m++)this._buffer[this._leftover+m]=c[h+m];this._leftover+=f}return this},u.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},u.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},u}();t.Poly1305=i;function n(u,c){var h=new i(u);h.update(c);var f=h.digest();return h.clean(),f}t.oneTimeAuth=n;function s(u,c){return u.length!==t.DIGEST_LENGTH||c.length!==t.DIGEST_LENGTH?!1:e.equal(u,c)}t.equal=s}(ws),function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=Xr,r=ws,i=dt,n=te,s=Ft;t.KEY_LENGTH=32,t.NONCE_LENGTH=12,t.TAG_LENGTH=16;var u=new Uint8Array(16),c=function(){function h(f){if(this.nonceLength=t.NONCE_LENGTH,this.tagLength=t.TAG_LENGTH,f.length!==t.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return h.prototype.seal=function(f,d,m,C){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var y=new Uint8Array(16);y.set(f,y.length-f.length);var b=new Uint8Array(32);e.stream(this._key,y,b,4);var L=d.length+this.tagLength,v;if(C){if(C.length!==L)throw new Error("ChaCha20Poly1305: incorrect destination length");v=C}else v=new Uint8Array(L);return e.streamXOR(this._key,y,d,v,4),this._authenticate(v.subarray(v.length-this.tagLength,v.length),b,v.subarray(0,v.length-this.tagLength),m),i.wipe(y),v},h.prototype.open=function(f,d,m,C){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(d.length<this.tagLength)return null;var y=new Uint8Array(16);y.set(f,y.length-f.length);var b=new Uint8Array(32);e.stream(this._key,y,b,4);var L=new Uint8Array(this.tagLength);if(this._authenticate(L,b,d.subarray(0,d.length-this.tagLength),m),!s.equal(L,d.subarray(d.length-this.tagLength,d.length)))return null;var v=d.length-this.tagLength,S;if(C){if(C.length!==v)throw new Error("ChaCha20Poly1305: incorrect destination length");S=C}else S=new Uint8Array(v);return e.streamXOR(this._key,y,d.subarray(0,d.length-this.tagLength),S,4),i.wipe(y),S},h.prototype.clean=function(){return i.wipe(this._key),this},h.prototype._authenticate=function(f,d,m,C){var y=new r.Poly1305(d);C&&(y.update(C),C.length%16>0&&y.update(u.subarray(C.length%16))),y.update(m),m.length%16>0&&y.update(u.subarray(m.length%16));var b=new Uint8Array(8);C&&n.writeUint64LE(C.length,b),y.update(b),n.writeUint64LE(m.length,b),y.update(b);for(var L=y.digest(),v=0;v<L.length;v++)f[v]=L[v];y.clean(),i.wipe(L),i.wipe(b)},h}();t.ChaCha20Poly1305=c}(zi);var ms={},Dr={},Ki={};Object.defineProperty(Ki,"__esModule",{value:!0});function kh(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}Ki.isSerializableHash=kh,Object.defineProperty(Dr,"__esModule",{value:!0});var Ot=Ki,Jh=Ft,Zh=dt,Ds=function(){function t(e,r){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var i=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(i).clean():i.set(r);for(var n=0;n<i.length;n++)i[n]^=54;this._inner.update(i);for(var n=0;n<i.length;n++)i[n]^=106;this._outer.update(i),Ot.isSerializableHash(this._inner)&&Ot.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Zh.wipe(i)}return t.prototype.reset=function(){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.clean=function(){Ot.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ot.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},t.prototype.update=function(e){return this._inner.update(e),this},t.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},t.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},t.prototype.saveState=function(){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},t.prototype.restoreState=function(e){if(!Ot.isSerializableHash(this._inner)||!Ot.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},t.prototype.cleanSavedState=function(e){if(!Ot.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},t}();Dr.HMAC=Ds;function Qh(t,e,r){var i=new Ds(t,e);i.update(r);var n=i.digest();return i.clean(),n}Dr.hmac=Qh,Dr.equal=Jh.equal,Object.defineProperty(ms,"__esModule",{value:!0});var Ss=Dr,xs=dt,ef=function(){function t(e,r,i,n){i===void 0&&(i=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=n;var s=Ss.hmac(this._hash,i,r);this._hmac=new Ss.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return t.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},t.prototype.expand=function(e){for(var r=new Uint8Array(e),i=0;i<r.length;i++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[i]=this._buffer[this._bufpos++];return r},t.prototype.clean=function(){this._hmac.clean(),xs.wipe(this._buffer),xs.wipe(this._counter),this._bufpos=0},t}(),tf=ms.HKDF=ef,kr={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=te,r=dt;t.DIGEST_LENGTH=32,t.BLOCK_SIZE=64;var i=function(){function c(){this.digestLength=t.DIGEST_LENGTH,this.blockSize=t.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(h,f){if(f===void 0&&(f=h.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var d=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=h[d++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(d=s(this._temp,this._state,h,d,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=h[d++],f--;return this},c.prototype.finish=function(h){if(!this._finished){var f=this._bytesHashed,d=this._bufferLength,m=f/536870912|0,C=f<<3,y=f%64<56?64:128;this._buffer[d]=128;for(var b=d+1;b<y-8;b++)this._buffer[b]=0;e.writeUint32BE(m,this._buffer,y-8),e.writeUint32BE(C,this._buffer,y-4),s(this._temp,this._state,this._buffer,0,y),this._finished=!0}for(var b=0;b<this.digestLength/4;b++)e.writeUint32BE(this._state[b],h,b*4);return this},c.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(h){return this._state.set(h.state),this._bufferLength=h.bufferLength,h.buffer&&this._buffer.set(h.buffer),this._bytesHashed=h.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(h){r.wipe(h.state),h.buffer&&r.wipe(h.buffer),h.bufferLength=0,h.bytesHashed=0},c}();t.SHA256=i;var n=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,h,f,d,m){for(;m>=64;){for(var C=h[0],y=h[1],b=h[2],L=h[3],v=h[4],S=h[5],R=h[6],A=h[7],D=0;D<16;D++){var T=d+D*4;c[D]=e.readUint32BE(f,T)}for(var D=16;D<64;D++){var _=c[D-2],o=(_>>>17|_<<32-17)^(_>>>19|_<<32-19)^_>>>10;_=c[D-15];var p=(_>>>7|_<<32-7)^(_>>>18|_<<32-18)^_>>>3;c[D]=(o+c[D-7]|0)+(p+c[D-16]|0)}for(var D=0;D<64;D++){var o=(((v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7))+(v&S^~v&R)|0)+(A+(n[D]+c[D]|0)|0)|0,p=((C>>>2|C<<32-2)^(C>>>13|C<<32-13)^(C>>>22|C<<32-22))+(C&y^C&b^y&b)|0;A=R,R=S,S=v,v=L+o|0,L=b,b=y,y=C,C=o+p|0}h[0]+=C,h[1]+=y,h[2]+=b,h[3]+=L,h[4]+=v,h[5]+=S,h[6]+=R,h[7]+=A,d+=64,m-=64}return d}function u(c){var h=new i;h.update(c);var f=h.digest();return h.clean(),f}t.hash=u})(kr);var Hi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0});var e=or,r=dt;t.PUBLIC_KEY_LENGTH=32,t.SECRET_KEY_LENGTH=32,t.SHARED_KEY_LENGTH=32;function i(D){var T=new Float64Array(16);if(D)for(var _=0;_<D.length;_++)T[_]=D[_];return T}var n=new Uint8Array(32);n[0]=9;var s=i([56129,1]);function u(D){for(var T=1,_=0;_<16;_++){var o=D[_]+T+65535;T=Math.floor(o/65536),D[_]=o-T*65536}D[0]+=T-1+37*(T-1)}function c(D,T,_){for(var o=~(_-1),p=0;p<16;p++){var j=o&(D[p]^T[p]);D[p]^=j,T[p]^=j}}function h(D,T){for(var _=i(),o=i(),p=0;p<16;p++)o[p]=T[p];u(o),u(o),u(o);for(var j=0;j<2;j++){_[0]=o[0]-65517;for(var p=1;p<15;p++)_[p]=o[p]-65535-(_[p-1]>>16&1),_[p-1]&=65535;_[15]=o[15]-32767-(_[14]>>16&1);var K=_[15]>>16&1;_[14]&=65535,c(o,_,1-K)}for(var p=0;p<16;p++)D[2*p]=o[p]&255,D[2*p+1]=o[p]>>8}function f(D,T){for(var _=0;_<16;_++)D[_]=T[2*_]+(T[2*_+1]<<8);D[15]&=32767}function d(D,T,_){for(var o=0;o<16;o++)D[o]=T[o]+_[o]}function m(D,T,_){for(var o=0;o<16;o++)D[o]=T[o]-_[o]}function C(D,T,_){var o,p,j=0,K=0,X=0,k=0,J=0,x=0,N=0,V=0,G=0,F=0,U=0,M=0,$=0,ie=0,B=0,Q=0,W=0,ae=0,I=0,O=0,w=0,a=0,g=0,z=0,Y=0,fe=0,_e=0,de=0,we=0,Ue=0,Ce=0,ve=_[0],pe=_[1],le=_[2],ue=_[3],ce=_[4],oe=_[5],se=_[6],ee=_[7],he=_[8],ge=_[9],re=_[10],ye=_[11],be=_[12],De=_[13],Se=_[14],Ee=_[15];o=T[0],j+=o*ve,K+=o*pe,X+=o*le,k+=o*ue,J+=o*ce,x+=o*oe,N+=o*se,V+=o*ee,G+=o*he,F+=o*ge,U+=o*re,M+=o*ye,$+=o*be,ie+=o*De,B+=o*Se,Q+=o*Ee,o=T[1],K+=o*ve,X+=o*pe,k+=o*le,J+=o*ue,x+=o*ce,N+=o*oe,V+=o*se,G+=o*ee,F+=o*he,U+=o*ge,M+=o*re,$+=o*ye,ie+=o*be,B+=o*De,Q+=o*Se,W+=o*Ee,o=T[2],X+=o*ve,k+=o*pe,J+=o*le,x+=o*ue,N+=o*ce,V+=o*oe,G+=o*se,F+=o*ee,U+=o*he,M+=o*ge,$+=o*re,ie+=o*ye,B+=o*be,Q+=o*De,W+=o*Se,ae+=o*Ee,o=T[3],k+=o*ve,J+=o*pe,x+=o*le,N+=o*ue,V+=o*ce,G+=o*oe,F+=o*se,U+=o*ee,M+=o*he,$+=o*ge,ie+=o*re,B+=o*ye,Q+=o*be,W+=o*De,ae+=o*Se,I+=o*Ee,o=T[4],J+=o*ve,x+=o*pe,N+=o*le,V+=o*ue,G+=o*ce,F+=o*oe,U+=o*se,M+=o*ee,$+=o*he,ie+=o*ge,B+=o*re,Q+=o*ye,W+=o*be,ae+=o*De,I+=o*Se,O+=o*Ee,o=T[5],x+=o*ve,N+=o*pe,V+=o*le,G+=o*ue,F+=o*ce,U+=o*oe,M+=o*se,$+=o*ee,ie+=o*he,B+=o*ge,Q+=o*re,W+=o*ye,ae+=o*be,I+=o*De,O+=o*Se,w+=o*Ee,o=T[6],N+=o*ve,V+=o*pe,G+=o*le,F+=o*ue,U+=o*ce,M+=o*oe,$+=o*se,ie+=o*ee,B+=o*he,Q+=o*ge,W+=o*re,ae+=o*ye,I+=o*be,O+=o*De,w+=o*Se,a+=o*Ee,o=T[7],V+=o*ve,G+=o*pe,F+=o*le,U+=o*ue,M+=o*ce,$+=o*oe,ie+=o*se,B+=o*ee,Q+=o*he,W+=o*ge,ae+=o*re,I+=o*ye,O+=o*be,w+=o*De,a+=o*Se,g+=o*Ee,o=T[8],G+=o*ve,F+=o*pe,U+=o*le,M+=o*ue,$+=o*ce,ie+=o*oe,B+=o*se,Q+=o*ee,W+=o*he,ae+=o*ge,I+=o*re,O+=o*ye,w+=o*be,a+=o*De,g+=o*Se,z+=o*Ee,o=T[9],F+=o*ve,U+=o*pe,M+=o*le,$+=o*ue,ie+=o*ce,B+=o*oe,Q+=o*se,W+=o*ee,ae+=o*he,I+=o*ge,O+=o*re,w+=o*ye,a+=o*be,g+=o*De,z+=o*Se,Y+=o*Ee,o=T[10],U+=o*ve,M+=o*pe,$+=o*le,ie+=o*ue,B+=o*ce,Q+=o*oe,W+=o*se,ae+=o*ee,I+=o*he,O+=o*ge,w+=o*re,a+=o*ye,g+=o*be,z+=o*De,Y+=o*Se,fe+=o*Ee,o=T[11],M+=o*ve,$+=o*pe,ie+=o*le,B+=o*ue,Q+=o*ce,W+=o*oe,ae+=o*se,I+=o*ee,O+=o*he,w+=o*ge,a+=o*re,g+=o*ye,z+=o*be,Y+=o*De,fe+=o*Se,_e+=o*Ee,o=T[12],$+=o*ve,ie+=o*pe,B+=o*le,Q+=o*ue,W+=o*ce,ae+=o*oe,I+=o*se,O+=o*ee,w+=o*he,a+=o*ge,g+=o*re,z+=o*ye,Y+=o*be,fe+=o*De,_e+=o*Se,de+=o*Ee,o=T[13],ie+=o*ve,B+=o*pe,Q+=o*le,W+=o*ue,ae+=o*ce,I+=o*oe,O+=o*se,w+=o*ee,a+=o*he,g+=o*ge,z+=o*re,Y+=o*ye,fe+=o*be,_e+=o*De,de+=o*Se,we+=o*Ee,o=T[14],B+=o*ve,Q+=o*pe,W+=o*le,ae+=o*ue,I+=o*ce,O+=o*oe,w+=o*se,a+=o*ee,g+=o*he,z+=o*ge,Y+=o*re,fe+=o*ye,_e+=o*be,de+=o*De,we+=o*Se,Ue+=o*Ee,o=T[15],Q+=o*ve,W+=o*pe,ae+=o*le,I+=o*ue,O+=o*ce,w+=o*oe,a+=o*se,g+=o*ee,z+=o*he,Y+=o*ge,fe+=o*re,_e+=o*ye,de+=o*be,we+=o*De,Ue+=o*Se,Ce+=o*Ee,j+=38*W,K+=38*ae,X+=38*I,k+=38*O,J+=38*w,x+=38*a,N+=38*g,V+=38*z,G+=38*Y,F+=38*fe,U+=38*_e,M+=38*de,$+=38*we,ie+=38*Ue,B+=38*Ce,p=1,o=j+p+65535,p=Math.floor(o/65536),j=o-p*65536,o=K+p+65535,p=Math.floor(o/65536),K=o-p*65536,o=X+p+65535,p=Math.floor(o/65536),X=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=J+p+65535,p=Math.floor(o/65536),J=o-p*65536,o=x+p+65535,p=Math.floor(o/65536),x=o-p*65536,o=N+p+65535,p=Math.floor(o/65536),N=o-p*65536,o=V+p+65535,p=Math.floor(o/65536),V=o-p*65536,o=G+p+65535,p=Math.floor(o/65536),G=o-p*65536,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=$+p+65535,p=Math.floor(o/65536),$=o-p*65536,o=ie+p+65535,p=Math.floor(o/65536),ie=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,j+=p-1+37*(p-1),p=1,o=j+p+65535,p=Math.floor(o/65536),j=o-p*65536,o=K+p+65535,p=Math.floor(o/65536),K=o-p*65536,o=X+p+65535,p=Math.floor(o/65536),X=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=J+p+65535,p=Math.floor(o/65536),J=o-p*65536,o=x+p+65535,p=Math.floor(o/65536),x=o-p*65536,o=N+p+65535,p=Math.floor(o/65536),N=o-p*65536,o=V+p+65535,p=Math.floor(o/65536),V=o-p*65536,o=G+p+65535,p=Math.floor(o/65536),G=o-p*65536,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=$+p+65535,p=Math.floor(o/65536),$=o-p*65536,o=ie+p+65535,p=Math.floor(o/65536),ie=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,j+=p-1+37*(p-1),D[0]=j,D[1]=K,D[2]=X,D[3]=k,D[4]=J,D[5]=x,D[6]=N,D[7]=V,D[8]=G,D[9]=F,D[10]=U,D[11]=M,D[12]=$,D[13]=ie,D[14]=B,D[15]=Q}function y(D,T){C(D,T,T)}function b(D,T){for(var _=i(),o=0;o<16;o++)_[o]=T[o];for(var o=253;o>=0;o--)y(_,_),o!==2&&o!==4&&C(_,_,T);for(var o=0;o<16;o++)D[o]=_[o]}function L(D,T){for(var _=new Uint8Array(32),o=new Float64Array(80),p=i(),j=i(),K=i(),X=i(),k=i(),J=i(),x=0;x<31;x++)_[x]=D[x];_[31]=D[31]&127|64,_[0]&=248,f(o,T);for(var x=0;x<16;x++)j[x]=o[x];p[0]=X[0]=1;for(var x=254;x>=0;--x){var N=_[x>>>3]>>>(x&7)&1;c(p,j,N),c(K,X,N),d(k,p,K),m(p,p,K),d(K,j,X),m(j,j,X),y(X,k),y(J,p),C(p,K,p),C(K,j,k),d(k,p,K),m(p,p,K),y(j,p),m(K,X,J),C(p,K,s),d(p,p,X),C(K,K,p),C(p,X,J),C(X,j,o),y(j,k),c(p,j,N),c(K,X,N)}for(var x=0;x<16;x++)o[x+16]=p[x],o[x+32]=K[x],o[x+48]=j[x],o[x+64]=X[x];var V=o.subarray(32),G=o.subarray(16);b(V,V),C(G,G,V);var F=new Uint8Array(32);return h(F,G),F}t.scalarMult=L;function v(D){return L(D,n)}t.scalarMultBase=v;function S(D){if(D.length!==t.SECRET_KEY_LENGTH)throw new Error("x25519: seed must be "+t.SECRET_KEY_LENGTH+" bytes");var T=new Uint8Array(D),_=v(T);return{publicKey:_,secretKey:T}}t.generateKeyPairFromSeed=S;function R(D){var T=e.randomBytes(32,D),_=S(T);return r.wipe(T),_}t.generateKeyPair=R;function A(D,T,_){if(_===void 0&&(_=!1),D.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(T.length!==t.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");var o=L(D,T);if(_){for(var p=0,j=0;j<o.length;j++)p|=o[j];if(p===0)throw new Error("X25519: invalid shared key")}return o}t.sharedKey=A})(Hi);var Os=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},rf=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),nf=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=process.platform}return t}(),sf=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),of=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),af=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),cf=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,uf=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Is=3,hf=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",cf]],As=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ff(t){return t?Ns(t):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new af:typeof navigator<"u"?Ns(navigator.userAgent):pf()}function lf(t){return t!==""&&hf.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function Ns(t){var e=lf(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new of;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Is&&(n=Os(Os([],n,!0),gf(Is-n.length),!0)):n=[];var s=n.join("."),u=df(t),c=uf.exec(t);return c&&c[1]?new sf(r,s,u,c[1]):new rf(r,s,u)}function df(t){for(var e=0,r=As.length;e<r;e++){var i=As[e],n=i[0],s=i[1],u=s.exec(t);if(u)return n}return null}function pf(){var t=typeof process<"u"&&process.version;return t?new nf(process.version.slice(1)):null}function gf(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=Cs=Oe.getLocation=Oe.getLocationOrThrow=Vi=Oe.getNavigator=Oe.getNavigatorOrThrow=Ts=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function Gt(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Oe.getFromWindow=Gt;function ar(t){const e=Gt(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Oe.getFromWindowOrThrow=ar;function vf(){return ar("document")}Oe.getDocumentOrThrow=vf;function _f(){return Gt("document")}var Ts=Oe.getDocument=_f;function yf(){return ar("navigator")}Oe.getNavigatorOrThrow=yf;function bf(){return Gt("navigator")}var Vi=Oe.getNavigator=bf;function wf(){return ar("location")}Oe.getLocationOrThrow=wf;function Ef(){return Gt("location")}var Cs=Oe.getLocation=Ef;function mf(){return ar("crypto")}Oe.getCryptoOrThrow=mf;function Df(){return Gt("crypto")}Oe.getCrypto=Df;function Sf(){return ar("localStorage")}Oe.getLocalStorageOrThrow=Sf;function xf(){return Gt("localStorage")}Oe.getLocalStorage=xf;var qi={};Object.defineProperty(qi,"__esModule",{value:!0});var Rs=qi.getWindowMetadata=void 0;const Ls=Oe;function Of(){let t,e;try{t=Ls.getDocumentOrThrow(),e=Ls.getLocationOrThrow()}catch{return null}function r(){const m=t.getElementsByTagName("link"),C=[];for(let y=0;y<m.length;y++){const b=m[y],L=b.getAttribute("rel");if(L&&L.toLowerCase().indexOf("icon")>-1){const v=b.getAttribute("href");if(v)if(v.toLowerCase().indexOf("https:")===-1&&v.toLowerCase().indexOf("http:")===-1&&v.indexOf("//")!==0){let S=e.protocol+"//"+e.host;if(v.indexOf("/")===0)S+=v;else{const R=e.pathname.split("/");R.pop(),S+=R.join("/")+"/"+v}C.push(S)}else if(v.indexOf("//")===0){const S=e.protocol+v;C.push(S)}else C.push(v)}}return C}function i(...m){const C=t.getElementsByTagName("meta");for(let y=0;y<C.length;y++){const b=C[y],L=["itemprop","property","name"].map(v=>b.getAttribute(v)).filter(v=>v?m.includes(v):!1);if(L.length&&L){const v=b.getAttribute("content");if(v)return v}}return""}function n(){let m=i("name","og:site_name","og:title","twitter:title");return m||(m=t.title),m}function s(){return i("description","og:description","twitter:description","keywords")}const u=n(),c=s(),h=e.origin,f=r();return{description:c,url:h,icons:f,name:u}}Rs=qi.getWindowMetadata=Of;var Sr={},If=t=>encodeURIComponent(t).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Ps="%[a-f0-9]{2}",Fs=new RegExp(Ps,"gi"),Us=new RegExp("("+Ps+")+","gi");function Gi(t,e){try{return decodeURIComponent(t.join(""))}catch{}if(t.length===1)return t;e=e||1;var r=t.slice(0,e),i=t.slice(e);return Array.prototype.concat.call([],Gi(r),Gi(i))}function Af(t){try{return decodeURIComponent(t)}catch{for(var e=t.match(Fs),r=1;r<e.length;r++)t=Gi(e,r).join(""),e=t.match(Fs);return t}}function Nf(t){for(var e={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Us.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch{var i=Af(r[0]);i!==r[0]&&(e[r[0]]=i)}r=Us.exec(t)}e["%C2"]="\uFFFD";for(var n=Object.keys(e),s=0;s<n.length;s++){var u=n[s];t=t.replace(new RegExp(u,"g"),e[u])}return t}var Tf=function(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch{return Nf(t)}},Cf=(t,e)=>{if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[t];const r=t.indexOf(e);return r===-1?[t]:[t.slice(0,r),t.slice(r+e.length)]};(function(t){const e=If,r=Tf,i=Cf,n=v=>v==null;function s(v){switch(v.arrayFormat){case"index":return S=>(R,A)=>{const D=R.length;return A===void 0||v.skipNull&&A===null||v.skipEmptyString&&A===""?R:A===null?[...R,[h(S,v),"[",D,"]"].join("")]:[...R,[h(S,v),"[",h(D,v),"]=",h(A,v)].join("")]};case"bracket":return S=>(R,A)=>A===void 0||v.skipNull&&A===null||v.skipEmptyString&&A===""?R:A===null?[...R,[h(S,v),"[]"].join("")]:[...R,[h(S,v),"[]=",h(A,v)].join("")];case"comma":case"separator":return S=>(R,A)=>A==null||A.length===0?R:R.length===0?[[h(S,v),"=",h(A,v)].join("")]:[[R,h(A,v)].join(v.arrayFormatSeparator)];default:return S=>(R,A)=>A===void 0||v.skipNull&&A===null||v.skipEmptyString&&A===""?R:A===null?[...R,h(S,v)]:[...R,[h(S,v),"=",h(A,v)].join("")]}}function u(v){let S;switch(v.arrayFormat){case"index":return(R,A,D)=>{if(S=/\[(\d*)\]$/.exec(R),R=R.replace(/\[\d*\]$/,""),!S){D[R]=A;return}D[R]===void 0&&(D[R]={}),D[R][S[1]]=A};case"bracket":return(R,A,D)=>{if(S=/(\[\])$/.exec(R),R=R.replace(/\[\]$/,""),!S){D[R]=A;return}if(D[R]===void 0){D[R]=[A];return}D[R]=[].concat(D[R],A)};case"comma":case"separator":return(R,A,D)=>{const _=typeof A=="string"&&A.split("").indexOf(v.arrayFormatSeparator)>-1?A.split(v.arrayFormatSeparator).map(o=>f(o,v)):A===null?A:f(A,v);D[R]=_};default:return(R,A,D)=>{if(D[R]===void 0){D[R]=A;return}D[R]=[].concat(D[R],A)}}}function c(v){if(typeof v!="string"||v.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function h(v,S){return S.encode?S.strict?e(v):encodeURIComponent(v):v}function f(v,S){return S.decode?r(v):v}function d(v){return Array.isArray(v)?v.sort():typeof v=="object"?d(Object.keys(v)).sort((S,R)=>Number(S)-Number(R)).map(S=>v[S]):v}function m(v){const S=v.indexOf("#");return S!==-1&&(v=v.slice(0,S)),v}function C(v){let S="";const R=v.indexOf("#");return R!==-1&&(S=v.slice(R)),S}function y(v){v=m(v);const S=v.indexOf("?");return S===-1?"":v.slice(S+1)}function b(v,S){return S.parseNumbers&&!Number.isNaN(Number(v))&&typeof v=="string"&&v.trim()!==""?v=Number(v):S.parseBooleans&&v!==null&&(v.toLowerCase()==="true"||v.toLowerCase()==="false")&&(v=v.toLowerCase()==="true"),v}function L(v,S){S=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},S),c(S.arrayFormatSeparator);const R=u(S),A=Object.create(null);if(typeof v!="string"||(v=v.trim().replace(/^[?#&]/,""),!v))return A;for(const D of v.split("&")){let[T,_]=i(S.decode?D.replace(/\+/g," "):D,"=");_=_===void 0?null:["comma","separator"].includes(S.arrayFormat)?_:f(_,S),R(f(T,S),_,A)}for(const D of Object.keys(A)){const T=A[D];if(typeof T=="object"&&T!==null)for(const _ of Object.keys(T))T[_]=b(T[_],S);else A[D]=b(T,S)}return S.sort===!1?A:(S.sort===!0?Object.keys(A).sort():Object.keys(A).sort(S.sort)).reduce((D,T)=>{const _=A[T];return Boolean(_)&&typeof _=="object"&&!Array.isArray(_)?D[T]=d(_):D[T]=_,D},Object.create(null))}t.extract=y,t.parse=L,t.stringify=(v,S)=>{if(!v)return"";S=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},S),c(S.arrayFormatSeparator);const R=_=>S.skipNull&&n(v[_])||S.skipEmptyString&&v[_]==="",A=s(S),D={};for(const _ of Object.keys(v))R(_)||(D[_]=v[_]);const T=Object.keys(D);return S.sort!==!1&&T.sort(S.sort),T.map(_=>{const o=v[_];return o===void 0?"":o===null?h(_,S):Array.isArray(o)?o.reduce(A(_),[]).join("&"):h(_,S)+"="+h(o,S)}).filter(_=>_.length>0).join("&")},t.parseUrl=(v,S)=>{S=Object.assign({decode:!0},S);const[R,A]=i(v,"#");return Object.assign({url:R.split("?")[0]||"",query:L(y(v),S)},S&&S.parseFragmentIdentifier&&A?{fragmentIdentifier:f(A,S)}:{})},t.stringifyUrl=(v,S)=>{S=Object.assign({encode:!0,strict:!0},S);const R=m(v.url).split("?")[0]||"",A=t.extract(v.url),D=t.parse(A,{sort:!1}),T=Object.assign(D,v.query);let _=t.stringify(T,S);_&&(_=`?${_}`);let o=C(v.url);return v.fragmentIdentifier&&(o=`#${h(v.fragmentIdentifier,S)}`),`${R}${_}${o}`}})(Sr);const Rf={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}},Ms="base10",ft="base16",Wi="base64pad",Yi="utf8",js=0,xr=1,Lf=0,$s=1,Xi=12,ki=32;function Pf(){const t=Hi.generateKeyPair();return{privateKey:ut(t.secretKey,ft),publicKey:ut(t.publicKey,ft)}}function Ji(){const t=or.randomBytes(ki);return ut(t,ft)}function Ff(t,e){const r=Hi.sharedKey(ht(t,ft),ht(e,ft)),i=new tf(kr.SHA256,r).expand(ki);return ut(i,ft)}function Uf(t){const e=kr.hash(ht(t,ft));return ut(e,ft)}function Jr(t){const e=kr.hash(ht(t,Yi));return ut(e,ft)}function Mf(t){return ht(`${t}`,Ms)}function Zr(t){return Number(ut(t,Ms))}function jf(t){const e=Mf(typeof t.type<"u"?t.type:js);if(Zr(e)===xr&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?ht(t.senderPublicKey,ft):void 0,i=typeof t.iv<"u"?ht(t.iv,ft):or.randomBytes(Xi),n=new zi.ChaCha20Poly1305(ht(t.symKey,ft)).seal(i,ht(t.message,Yi));return zf({type:e,sealed:n,iv:i,senderPublicKey:r})}function $f(t){const e=new zi.ChaCha20Poly1305(ht(t.symKey,ft)),{sealed:r,iv:i}=zs(t.encoded),n=e.open(i,r);if(n===null)throw new Error("Failed to decrypt");return ut(n,Yi)}function zf(t){if(Zr(t.type)===xr){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ut(Ui([t.type,t.senderPublicKey,t.iv,t.sealed]),Wi)}return ut(Ui([t.type,t.iv,t.sealed]),Wi)}function zs(t){const e=ht(t,Wi),r=e.slice(Lf,$s),i=$s;if(Zr(r)===xr){const c=i+ki,h=c+Xi,f=e.slice(i,c),d=e.slice(c,h),m=e.slice(h);return{type:r,sealed:m,iv:d,senderPublicKey:f}}const n=i+Xi,s=e.slice(i,n),u=e.slice(n);return{type:r,sealed:u,iv:s}}function Bf(t,e){const r=zs(t);return Bs({type:Zr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ut(r.senderPublicKey,ft):void 0,receiverPublicKey:e?.receiverPublicKey})}function Bs(t){const e=t?.type||js;if(e===xr){if(typeof t?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof t?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t?.senderPublicKey,receiverPublicKey:t?.receiverPublicKey}}function Ks(t){return t.type===xr&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}var Kf=Object.defineProperty,Hs=Object.getOwnPropertySymbols,Hf=Object.prototype.hasOwnProperty,Vf=Object.prototype.propertyIsEnumerable,Vs=(t,e,r)=>e in t?Kf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,qs=(t,e)=>{for(var r in e||(e={}))Hf.call(e,r)&&Vs(t,r,e[r]);if(Hs)for(var r of Hs(e))Vf.call(e,r)&&Vs(t,r,e[r]);return t};const qf="ReactNative",Or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},Gf="js";function Gs(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Wf(){return!Ts()&&!!Vi()&&navigator.product===qf}function Yf(){return!Gs()&&!!Vi()}function Xf(){return Wf()?Or.reactNative:Gs()?Or.node:Yf()?Or.browser:Or.unknown}function kf(t,e){let r=Sr.parse(t);return r=qs(qs({},r),e),t=Sr.stringify(r),t}function Jf(){return Rs()||{name:"",description:"",url:"",icons:[""]}}function Zf(){const t=ff();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function Qf(){var t;const e=Xf();return e===Or.browser?[e,((t=Cs())==null?void 0:t.host)||"unknown"].join(":"):e}function el(t,e,r){const i=Zf(),n=Qf();return[[t,e].join("-"),[Gf,r].join("-"),i,n].join("/")}function tl({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s}){const u=r.split("?"),c=el(t,e,i),h={auth:n,ua:c,projectId:s},f=kf(u[1]||"",h);return u[0]+"?"+f}function lt(t,e){return t.filter(r=>e.includes(r)).length===t.length}function Ws(t){return Object.fromEntries(t.entries())}function Ys(t){return new Map(Object.entries(t))}function cr(t,e){return Ie.fromMiliseconds((e||Date.now())+Ie.toMiliseconds(t))}function Wt(t){return Ie.fromMiliseconds(Date.now())>=Ie.toMiliseconds(t)}function Yt(){const t=Ie.toMiliseconds(Ie.FIVE_MINUTES);let e,r,i;return{resolve:n=>{i&&e&&(clearTimeout(i),e(n))},reject:n=>{i&&r&&(clearTimeout(i),r(n))},done:()=>new Promise((n,s)=>{i=setTimeout(s,t),e=n,r=s})}}function Xs(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function rl(t){return Xs("topic",t)}function il(t){return Xs("id",t)}function nl(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function Fe(t,e){return`${t}${e?`:${e}`:""}`}const sl="iridium";function Zi(t){return t?.relay||{protocol:sl}}function Qi(t){const e=Rf[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}var ol=Object.defineProperty,ks=Object.getOwnPropertySymbols,al=Object.prototype.hasOwnProperty,cl=Object.prototype.propertyIsEnumerable,Js=(t,e,r)=>e in t?ol(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ul=(t,e)=>{for(var r in e||(e={}))al.call(e,r)&&Js(t,r,e[r]);if(ks)for(var r of ks(e))cl.call(e,r)&&Js(t,r,e[r]);return t};function hl(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),u=t[n];r[s]=u}}),r}function fl(t){const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",u=Sr.parse(s);return{protocol:i,topic:n[0],version:parseInt(n[1],10),symKey:u.symKey,relay:hl(u)}}function ll(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function dl(t){return`${t.protocol}:${t.topic}@${t.version}?`+Sr.stringify(ul({symKey:t.symKey},ll(t.relay)))}function It(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function pl(t){const e=[];return Object.values(t).forEach(r=>{e.push(...It(r.accounts)),r.extension&&r.extension.forEach(i=>{e.push(...It(i.accounts))})}),e}function gl(t,e){const r=[];return Object.values(t).forEach(i=>{It(i.accounts).includes(e)&&r.push(...i.methods),i.extension&&i.extension.forEach(n=>{It(n.accounts).includes(e)&&r.push(...n.methods)})}),r}function vl(t,e){const r=[];return Object.values(t).forEach(i=>{It(i.accounts).includes(e)&&r.push(...i.events),i.extension&&i.extension.forEach(n=>{It(n.accounts).includes(e)&&r.push(...n.events)})}),r}const _l={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3}},yl={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function H(t,e){const{message:r,code:i}=yl[t];return{message:e?`${r} ${e}`:r,code:i}}function nt(t,e){const{message:r,code:i}=_l[t];return{message:e?`${r} ${e}`:r,code:i}}function Ir(t,e){return Array.isArray(t)?typeof e<"u"&&t.length?t.every(e):!0:!1}function Zs(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function wt(t){return typeof t>"u"}function st(t,e){return e&&wt(t)?!0:typeof t=="string"&&Boolean(t.trim().length)}function Qs(t,e){return e&&wt(t)?!0:typeof t=="number"&&!isNaN(t)}function bl(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return lt(n,i)?(i.forEach(u=>{const{accounts:c,methods:h,events:f,extension:d}=t.namespaces[u],m=It(c),C=r[u];(!lt(C.chains,m)||!lt(C.methods,h)||!lt(C.events,f))&&(s=!1),s&&d&&d.forEach(y=>{var b;const{accounts:L,methods:v,events:S}=y,R=It(L);(b=C.extension)!=null&&b.find(A=>lt(A.chains,R)&&lt(A.methods,v)&&lt(A.events,S))||(s=!1)})}),s):!1}function en(t){return st(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function wl(t){if(st(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&en(r)}}return!1}function El(t){if(st(t,!1))try{return typeof new URL(t)<"u"}catch{return!1}return!1}function ml(t){var e;return(e=t?.proposer)==null?void 0:e.publicKey}function Dl(t){return t?.topic}function Sl(t,e){let r=null;return st(t?.publicKey,!1)||(r=H("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function tn(t,e){let r=null;return wt(t?.extension)||(!Ir(t.extension)||!t.extension.length)&&(r=H("MISSING_OR_INVALID",`${e} extension should be an array of namespaces, or omitted`)),r}function eo(t){let e=!0;return Ir(t)?t.length&&(e=t.every(r=>st(r,!1))):e=!1,e}function to(t,e,r){let i=null;return Ir(e)?e.forEach(n=>{i||(!en(n)||!n.includes(t))&&(i=nt("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):i=nt("UNSUPPORTED_CHAINS",`${r}, chains ${e} should be an array of strings conforming to "namespace:chainId" format`),i}function xl(t,e){let r=null;return Object.entries(t).forEach(([i,n])=>{if(r)return;const s=to(i,n?.chains,`${e} requiredNamespace`),u=tn(n,e);s?r=s:u?r=u:n.extension&&n.extension.forEach(c=>{if(r)return;const h=to(i,c.chains,`${e} extension`);h&&(r=h)})}),r}function ro(t,e){let r=null;return Ir(t)?t.forEach(i=>{r||wl(i)||(r=nt("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=nt("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Ol(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=ro(i?.accounts,`${e} namespace`),s=tn(i,e);n?r=n:s?r=s:i.extension&&i.extension.forEach(u=>{if(r)return;const c=ro(u.accounts,`${e} extension`);c&&(r=c)})}),r}function io(t,e){let r=null;return eo(t?.methods)?eo(t?.events)||(r=nt("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=nt("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function no(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=io(i,`${e}, namespace`),s=tn(i,e);n?r=n:s?r=s:i.extension&&i.extension.forEach(u=>{if(r)return;const c=io(u,`${e}, extension`);c&&(r=c)})}),r}function Il(t,e){let r=null;if(t&&Zs(t)){const i=no(t,e);i&&(r=i);const n=xl(t,e);n&&(r=n)}else r=H("MISSING_OR_INVALID",`${e}, requiredNamespaces should be an object with data`);return r}function rn(t,e){let r=null;if(t&&Zs(t)){const i=no(t,e);i&&(r=i);const n=Ol(t,e);n&&(r=n)}else r=H("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function so(t){return st(t.protocol,!0)}function Al(t,e){let r=!1;return e&&!t?r=!0:t&&Ir(t)&&t.length&&t.forEach(i=>{r=so(i)}),r}function Nl(t){return typeof t=="number"}function vt(t){return typeof t<"u"&&typeof t!==null}function Tl(t){return!(!t||typeof t!="object"||!t.code||!Qs(t.code,!1)||!t.message||!st(t.message,!1))}function Cl(t){return!(wt(t)||!st(t.method,!1))}function Rl(t){return!(wt(t)||wt(t.result)&&wt(t.error)||!Qs(t.id,!1)||!st(t.jsonrpc,!1))}function Ll(t){return!(wt(t)||!st(t.name,!1))}function oo(t,e){return!(!en(e)||!pl(t).includes(e))}function Pl(t,e,r){return st(r,!1)?gl(t,e).includes(r):!1}function Fl(t,e,r){return st(r,!1)?vl(t,e).includes(r):!1}function ao(t,e,r){let i=null;const n=Object.keys(t),s=Object.keys(e);return lt(n,s)?n.forEach(u=>{var c;if(i)return;const h=t[u].chains,f=It(e[u].accounts);lt(h,f)?lt(t[u].methods,e[u].methods)?lt(t[u].events,e[u].events)?t[u].extension&&!e[u].extension?i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${u}`):t[u].extension&&e[u].extension&&((c=t[u].extension)==null||c.forEach(({methods:d,events:m,chains:C})=>{var y;i||(y=e[u].extension)!=null&&y.find(b=>{const L=It(b.accounts);return lt(C,L)&&lt(m,b.events)&&lt(d,b.methods)})||(i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces extension doesn't satisfy requiredNamespaces extension for ${u}`))})):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy requiredNamespaces events for ${u}`):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy requiredNamespaces methods for ${u}`):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy requiredNamespaces chains for ${u}`)}):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces`),i}const Ul="PARSE_ERROR",Ml="INVALID_REQUEST",jl="METHOD_NOT_FOUND",$l="INVALID_PARAMS",co="INTERNAL_ERROR",nn="SERVER_ERROR",zl=[-32700,-32600,-32601,-32602,-32603],Ar={[Ul]:{code:-32700,message:"Parse error"},[Ml]:{code:-32600,message:"Invalid Request"},[jl]:{code:-32601,message:"Method not found"},[$l]:{code:-32602,message:"Invalid params"},[co]:{code:-32603,message:"Internal error"},[nn]:{code:-32e3,message:"Server error"}},uo=nn;function Bl(t){return zl.includes(t)}function ho(t){return Object.keys(Ar).includes(t)?Ar[t]:Ar[uo]}function Kl(t){const e=Object.values(Ar).find(r=>r.code===t);return e||Ar[uo]}function Hl(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var fo={},Ut={};Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.isBrowserCryptoAvailable=Ut.getSubtleCrypto=Ut.getBrowerCrypto=void 0;function sn(){return Z?.crypto||Z?.msCrypto||{}}Ut.getBrowerCrypto=sn;function lo(){const t=sn();return t.subtle||t.webkitSubtle}Ut.getSubtleCrypto=lo;function Vl(){return!!sn()&&!!lo()}Ut.isBrowserCryptoAvailable=Vl;var Mt={};Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.isBrowser=Mt.isNode=Mt.isReactNative=void 0;function po(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Mt.isReactNative=po;function go(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Mt.isNode=go;function ql(){return!po()&&!go()}Mt.isBrowser=ql,function(t){var e=Z&&Z.__createBinding||(Object.create?function(i,n,s,u){u===void 0&&(u=s),Object.defineProperty(i,u,{enumerable:!0,get:function(){return n[s]}})}:function(i,n,s,u){u===void 0&&(u=s),i[u]=n[s]}),r=Z&&Z.__exportStar||function(i,n){for(var s in i)s!=="default"&&!n.hasOwnProperty(s)&&e(n,i,s)};Object.defineProperty(t,"__esModule",{value:!0}),r(Ut,t),r(Mt,t)}(fo);function Gl(){const t=Date.now()*Math.pow(10,3),e=Math.floor(Math.random()*Math.pow(10,3));return t+e}function on(t,e,r){return{id:r||Gl(),jsonrpc:"2.0",method:t,params:e}}function vo(t,e){return{id:t,jsonrpc:"2.0",result:e}}function _o(t,e,r){return{id:t,jsonrpc:"2.0",error:Wl(e,r)}}function Wl(t,e){return typeof t>"u"?ho(co):(typeof t=="string"&&(t=Object.assign(Object.assign({},ho(nn)),{message:t})),typeof e<"u"&&(t.data=e),Bl(t.code)&&(t=Kl(t.code)),t)}class Yl{}class Xl extends Yl{constructor(){super()}}class kl extends Xl{constructor(e){super()}}const Jl="^wss?:";function Zl(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function Ql(t,e){const r=Zl(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function yo(t){return Ql(t,Jl)}function ed(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function bo(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function wo(t){return bo(t)&&"method"in t}function Eo(t){return bo(t)&&(Ct(t)||Et(t))}function Ct(t){return"result"in t}function Et(t){return"error"in t}class td extends kl{constructor(e){super(e),this.events=new Ht.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(on(e.method,e.params||[]),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{Et(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Eo(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",e=>this.events.emit("error",e)),this.hasRegisteredEventListeners=!0)}}const rd=typeof global.WebSocket<"u"?global.WebSocket:require("ws");class id{constructor(e){if(this.url=e,this.events=new Ht.EventEmitter,this.registering=!1,!yo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(typeof this.socket>"u")throw new Error("Connection already closed");this.socket.close(),this.onClose()}async send(e,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ii(e))}catch(i){this.onError(e.id,i)}}register(e=this.url){if(!yo(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);return this.registering?new Promise((r,i)=>{this.events.once("register_error",n=>{i(n)}),this.events.once("open",()=>{if(typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));r(this.socket)})}):(this.url=e,this.registering=!0,new Promise((r,i)=>{const n=fo.isReactNative()?void 0:{rejectUnauthorized:!ed(e)},s=new rd(e,[],n);s.onopen=()=>{this.onOpen(s),r(s)},s.onerror=u=>{const c=this.parseError(u.error);this.events.emit("register_error",c),this.onClose(),i(c)}}))}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=()=>this.onClose(),e.onerror=r=>{const i=this.parseError(r.error);this.events.emit("error",i)},this.socket=e,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Kn(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=_o(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Hl(e,r,"WS")}}var an={exports:{}};(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,u=9007199254740991,c="[object Arguments]",h="[object Array]",f="[object AsyncFunction]",d="[object Boolean]",m="[object Date]",C="[object Error]",y="[object Function]",b="[object GeneratorFunction]",L="[object Map]",v="[object Number]",S="[object Null]",R="[object Object]",A="[object Promise]",D="[object Proxy]",T="[object RegExp]",_="[object Set]",o="[object String]",p="[object Symbol]",j="[object Undefined]",K="[object WeakMap]",X="[object ArrayBuffer]",k="[object DataView]",J="[object Float32Array]",x="[object Float64Array]",N="[object Int8Array]",V="[object Int16Array]",G="[object Int32Array]",F="[object Uint8Array]",U="[object Uint8ClampedArray]",M="[object Uint16Array]",$="[object Uint32Array]",ie=/[\\^$.*+?()[\]{}|]/g,B=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,W={};W[J]=W[x]=W[N]=W[V]=W[G]=W[F]=W[U]=W[M]=W[$]=!0,W[c]=W[h]=W[X]=W[d]=W[k]=W[m]=W[C]=W[y]=W[L]=W[v]=W[R]=W[T]=W[_]=W[o]=W[K]=!1;var ae=typeof Z=="object"&&Z&&Z.Object===Object&&Z,I=typeof self=="object"&&self&&self.Object===Object&&self,O=ae||I||Function("return this")(),w=e&&!e.nodeType&&e,a=w&&!0&&t&&!t.nodeType&&t,g=a&&a.exports===w,z=g&&ae.process,Y=function(){try{return z&&z.binding&&z.binding("util")}catch{}}(),fe=Y&&Y.isTypedArray;function _e(l,E){for(var P=-1,q=l==null?0:l.length,Ae=0,ne=[];++P<q;){var Pe=l[P];E(Pe,P,l)&&(ne[Ae++]=Pe)}return ne}function de(l,E){for(var P=-1,q=E.length,Ae=l.length;++P<q;)l[Ae+P]=E[P];return l}function we(l,E){for(var P=-1,q=l==null?0:l.length;++P<q;)if(E(l[P],P,l))return!0;return!1}function Ue(l,E){for(var P=-1,q=Array(l);++P<l;)q[P]=E(P);return q}function Ce(l){return function(E){return l(E)}}function ve(l,E){return l.has(E)}function pe(l,E){return l?.[E]}function le(l){var E=-1,P=Array(l.size);return l.forEach(function(q,Ae){P[++E]=[Ae,q]}),P}function ue(l,E){return function(P){return l(E(P))}}function ce(l){var E=-1,P=Array(l.size);return l.forEach(function(q){P[++E]=q}),P}var oe=Array.prototype,se=Function.prototype,ee=Object.prototype,he=O["__core-js_shared__"],ge=se.toString,re=ee.hasOwnProperty,ye=function(){var l=/[^.]+$/.exec(he&&he.keys&&he.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""}(),be=ee.toString,De=RegExp("^"+ge.call(re).replace(ie,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Se=g?O.Buffer:void 0,Ee=O.Symbol,Dt=O.Uint8Array,At=ee.propertyIsEnumerable,$t=oe.splice,pt=Ee?Ee.toStringTag:void 0,kt=Object.getOwnPropertySymbols,Pr=Se?Se.isBuffer:void 0,si=ue(Object.keys,Object),Me=fr(O,"DataView"),Re=fr(O,"Map"),je=fr(O,"Promise"),$e=fr(O,"Set"),ze=fr(O,"WeakMap"),Le=fr(Object,"create"),Ge=Zt(Me),We=Zt(Re),Ye=Zt(je),Xe=Zt($e),ke=Zt(ze),Ke=Ee?Ee.prototype:void 0,Be=Ke?Ke.valueOf:void 0;function Ne(l){var E=-1,P=l==null?0:l.length;for(this.clear();++E<P;){var q=l[E];this.set(q[0],q[1])}}function Je(){this.__data__=Le?Le(null):{},this.size=0}function Ze(l){var E=this.has(l)&&delete this.__data__[l];return this.size-=E?1:0,E}function Ug(l){var E=this.__data__;if(Le){var P=E[l];return P===i?void 0:P}return re.call(E,l)?E[l]:void 0}function Mg(l){var E=this.__data__;return Le?E[l]!==void 0:re.call(E,l)}function jg(l,E){var P=this.__data__;return this.size+=this.has(l)?0:1,P[l]=Le&&E===void 0?i:E,this}Ne.prototype.clear=Je,Ne.prototype.delete=Ze,Ne.prototype.get=Ug,Ne.prototype.has=Mg,Ne.prototype.set=jg;function Lt(l){var E=-1,P=l==null?0:l.length;for(this.clear();++E<P;){var q=l[E];this.set(q[0],q[1])}}function $g(){this.__data__=[],this.size=0}function zg(l){var E=this.__data__,P=ai(E,l);if(P<0)return!1;var q=E.length-1;return P==q?E.pop():$t.call(E,P,1),--this.size,!0}function Bg(l){var E=this.__data__,P=ai(E,l);return P<0?void 0:E[P][1]}function Kg(l){return ai(this.__data__,l)>-1}function Hg(l,E){var P=this.__data__,q=ai(P,l);return q<0?(++this.size,P.push([l,E])):P[q][1]=E,this}Lt.prototype.clear=$g,Lt.prototype.delete=zg,Lt.prototype.get=Bg,Lt.prototype.has=Kg,Lt.prototype.set=Hg;function Jt(l){var E=-1,P=l==null?0:l.length;for(this.clear();++E<P;){var q=l[E];this.set(q[0],q[1])}}function Vg(){this.size=0,this.__data__={hash:new Ne,map:new(Re||Lt),string:new Ne}}function qg(l){var E=ci(this,l).delete(l);return this.size-=E?1:0,E}function Gg(l){return ci(this,l).get(l)}function Wg(l){return ci(this,l).has(l)}function Yg(l,E){var P=ci(this,l),q=P.size;return P.set(l,E),this.size+=P.size==q?0:1,this}Jt.prototype.clear=Vg,Jt.prototype.delete=qg,Jt.prototype.get=Gg,Jt.prototype.has=Wg,Jt.prototype.set=Yg;function oi(l){var E=-1,P=l==null?0:l.length;for(this.__data__=new Jt;++E<P;)this.add(l[E])}function Xg(l){return this.__data__.set(l,i),this}function kg(l){return this.__data__.has(l)}oi.prototype.add=oi.prototype.push=Xg,oi.prototype.has=kg;function zt(l){var E=this.__data__=new Lt(l);this.size=E.size}function Jg(){this.__data__=new Lt,this.size=0}function Zg(l){var E=this.__data__,P=E.delete(l);return this.size=E.size,P}function Qg(l){return this.__data__.get(l)}function e0(l){return this.__data__.has(l)}function t0(l,E){var P=this.__data__;if(P instanceof Lt){var q=P.__data__;if(!Re||q.length<r-1)return q.push([l,E]),this.size=++P.size,this;P=this.__data__=new Jt(q)}return P.set(l,E),this.size=P.size,this}zt.prototype.clear=Jg,zt.prototype.delete=Zg,zt.prototype.get=Qg,zt.prototype.has=e0,zt.prototype.set=t0;function r0(l,E){var P=ui(l),q=!P&&_0(l),Ae=!P&&!q&&bn(l),ne=!P&&!q&&!Ae&&wa(l),Pe=P||q||Ae||ne,Qe=Pe?Ue(l.length,String):[],rt=Qe.length;for(var Te in l)(E||re.call(l,Te))&&!(Pe&&(Te=="length"||Ae&&(Te=="offset"||Te=="parent")||ne&&(Te=="buffer"||Te=="byteLength"||Te=="byteOffset")||l0(Te,rt)))&&Qe.push(Te);return Qe}function ai(l,E){for(var P=l.length;P--;)if(va(l[P][0],E))return P;return-1}function i0(l,E,P){var q=E(l);return ui(l)?q:de(q,P(l))}function Fr(l){return l==null?l===void 0?j:S:pt&&pt in Object(l)?h0(l):v0(l)}function la(l){return Ur(l)&&Fr(l)==c}function da(l,E,P,q,Ae){return l===E?!0:l==null||E==null||!Ur(l)&&!Ur(E)?l!==l&&E!==E:n0(l,E,P,q,da,Ae)}function n0(l,E,P,q,Ae,ne){var Pe=ui(l),Qe=ui(E),rt=Pe?h:Bt(l),Te=Qe?h:Bt(E);rt=rt==c?R:rt,Te=Te==c?R:Te;var gt=rt==R,St=Te==R,ot=rt==Te;if(ot&&bn(l)){if(!bn(E))return!1;Pe=!0,gt=!1}if(ot&&!gt)return ne||(ne=new zt),Pe||wa(l)?pa(l,E,P,q,Ae,ne):c0(l,E,rt,P,q,Ae,ne);if(!(P&n)){var yt=gt&&re.call(l,"__wrapped__"),bt=St&&re.call(E,"__wrapped__");if(yt||bt){var Kt=yt?l.value():l,Pt=bt?E.value():E;return ne||(ne=new zt),Ae(Kt,Pt,P,q,ne)}}return ot?(ne||(ne=new zt),u0(l,E,P,q,Ae,ne)):!1}function s0(l){if(!ba(l)||p0(l))return!1;var E=_a(l)?De:B;return E.test(Zt(l))}function o0(l){return Ur(l)&&ya(l.length)&&!!W[Fr(l)]}function a0(l){if(!g0(l))return si(l);var E=[];for(var P in Object(l))re.call(l,P)&&P!="constructor"&&E.push(P);return E}function pa(l,E,P,q,Ae,ne){var Pe=P&n,Qe=l.length,rt=E.length;if(Qe!=rt&&!(Pe&&rt>Qe))return!1;var Te=ne.get(l);if(Te&&ne.get(E))return Te==E;var gt=-1,St=!0,ot=P&s?new oi:void 0;for(ne.set(l,E),ne.set(E,l);++gt<Qe;){var yt=l[gt],bt=E[gt];if(q)var Kt=Pe?q(bt,yt,gt,E,l,ne):q(yt,bt,gt,l,E,ne);if(Kt!==void 0){if(Kt)continue;St=!1;break}if(ot){if(!we(E,function(Pt,Qt){if(!ve(ot,Qt)&&(yt===Pt||Ae(yt,Pt,P,q,ne)))return ot.push(Qt)})){St=!1;break}}else if(!(yt===bt||Ae(yt,bt,P,q,ne))){St=!1;break}}return ne.delete(l),ne.delete(E),St}function c0(l,E,P,q,Ae,ne,Pe){switch(P){case k:if(l.byteLength!=E.byteLength||l.byteOffset!=E.byteOffset)return!1;l=l.buffer,E=E.buffer;case X:return!(l.byteLength!=E.byteLength||!ne(new Dt(l),new Dt(E)));case d:case m:case v:return va(+l,+E);case C:return l.name==E.name&&l.message==E.message;case T:case o:return l==E+"";case L:var Qe=le;case _:var rt=q&n;if(Qe||(Qe=ce),l.size!=E.size&&!rt)return!1;var Te=Pe.get(l);if(Te)return Te==E;q|=s,Pe.set(l,E);var gt=pa(Qe(l),Qe(E),q,Ae,ne,Pe);return Pe.delete(l),gt;case p:if(Be)return Be.call(l)==Be.call(E)}return!1}function u0(l,E,P,q,Ae,ne){var Pe=P&n,Qe=ga(l),rt=Qe.length,Te=ga(E),gt=Te.length;if(rt!=gt&&!Pe)return!1;for(var St=rt;St--;){var ot=Qe[St];if(!(Pe?ot in E:re.call(E,ot)))return!1}var yt=ne.get(l);if(yt&&ne.get(E))return yt==E;var bt=!0;ne.set(l,E),ne.set(E,l);for(var Kt=Pe;++St<rt;){ot=Qe[St];var Pt=l[ot],Qt=E[ot];if(q)var Ea=Pe?q(Qt,Pt,ot,E,l,ne):q(Pt,Qt,ot,l,E,ne);if(!(Ea===void 0?Pt===Qt||Ae(Pt,Qt,P,q,ne):Ea)){bt=!1;break}Kt||(Kt=ot=="constructor")}if(bt&&!Kt){var hi=l.constructor,fi=E.constructor;hi!=fi&&"constructor"in l&&"constructor"in E&&!(typeof hi=="function"&&hi instanceof hi&&typeof fi=="function"&&fi instanceof fi)&&(bt=!1)}return ne.delete(l),ne.delete(E),bt}function ga(l){return i0(l,w0,f0)}function ci(l,E){var P=l.__data__;return d0(E)?P[typeof E=="string"?"string":"hash"]:P.map}function fr(l,E){var P=pe(l,E);return s0(P)?P:void 0}function h0(l){var E=re.call(l,pt),P=l[pt];try{l[pt]=void 0;var q=!0}catch{}var Ae=be.call(l);return q&&(E?l[pt]=P:delete l[pt]),Ae}var f0=kt?function(l){return l==null?[]:(l=Object(l),_e(kt(l),function(E){return At.call(l,E)}))}:E0,Bt=Fr;(Me&&Bt(new Me(new ArrayBuffer(1)))!=k||Re&&Bt(new Re)!=L||je&&Bt(je.resolve())!=A||$e&&Bt(new $e)!=_||ze&&Bt(new ze)!=K)&&(Bt=function(l){var E=Fr(l),P=E==R?l.constructor:void 0,q=P?Zt(P):"";if(q)switch(q){case Ge:return k;case We:return L;case Ye:return A;case Xe:return _;case ke:return K}return E});function l0(l,E){return E=E??u,!!E&&(typeof l=="number"||Q.test(l))&&l>-1&&l%1==0&&l<E}function d0(l){var E=typeof l;return E=="string"||E=="number"||E=="symbol"||E=="boolean"?l!=="__proto__":l===null}function p0(l){return!!ye&&ye in l}function g0(l){var E=l&&l.constructor,P=typeof E=="function"&&E.prototype||ee;return l===P}function v0(l){return be.call(l)}function Zt(l){if(l!=null){try{return ge.call(l)}catch{}try{return l+""}catch{}}return""}function va(l,E){return l===E||l!==l&&E!==E}var _0=la(function(){return arguments}())?la:function(l){return Ur(l)&&re.call(l,"callee")&&!At.call(l,"callee")},ui=Array.isArray;function y0(l){return l!=null&&ya(l.length)&&!_a(l)}var bn=Pr||m0;function b0(l,E){return da(l,E)}function _a(l){if(!ba(l))return!1;var E=Fr(l);return E==y||E==b||E==f||E==D}function ya(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=u}function ba(l){var E=typeof l;return l!=null&&(E=="object"||E=="function")}function Ur(l){return l!=null&&typeof l=="object"}var wa=fe?Ce(fe):o0;function w0(l){return y0(l)?r0(l):a0(l)}function E0(){return[]}function m0(){return!1}t.exports=b0})(an,an.exports);var nd=an.exports,sd=Object.defineProperty,mo=Object.getOwnPropertySymbols,od=Object.prototype.hasOwnProperty,ad=Object.prototype.propertyIsEnumerable,Do=(t,e,r)=>e in t?sd(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ct=(t,e)=>{for(var r in e||(e={}))od.call(e,r)&&Do(t,r,e[r]);if(mo)for(var r of mo(e))ad.call(e,r)&&Do(t,r,e[r]);return t};function qe(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}var Qr=qe;qe.EventEmitter=qe,qe.prototype._events=void 0,qe.prototype._maxListeners=void 0,qe.defaultMaxListeners=10,qe.prototype.setMaxListeners=function(t){if(!cd(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},qe.prototype.emit=function(t){var e,r,i,n,s,u;if(this._events||(this._events={}),t==="error"&&(!this._events.error||Nr(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var c=new Error('Uncaught, unspecified "error" event. ('+e+")");throw c.context=e,c}if(r=this._events[t],So(r))return!1;if(Rt(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),r.apply(this,n)}else if(Nr(r))for(n=Array.prototype.slice.call(arguments,1),u=r.slice(),i=u.length,s=0;s<i;s++)u[s].apply(this,n);return!0},qe.prototype.addListener=function(t,e){var r;if(!Rt(e))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,Rt(e.listener)?e.listener:e),this._events[t]?Nr(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,Nr(this._events[t])&&!this._events[t].warned&&(So(this._maxListeners)?r=qe.defaultMaxListeners:r=this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),typeof console.trace=="function"&&console.trace())),this},qe.prototype.on=qe.prototype.addListener,qe.prototype.once=function(t,e){if(!Rt(e))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(t,i),r||(r=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},qe.prototype.removeListener=function(t,e){var r,i,n,s;if(!Rt(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],n=r.length,i=-1,r===e||Rt(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(Nr(r)){for(s=n;s-- >0;)if(r[s]===e||r[s].listener&&r[s].listener===e){i=s;break}if(i<0)return this;r.length===1?(r.length=0,delete this._events[t]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},qe.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return arguments.length===0?this._events={}:this._events[t]&&delete this._events[t],this;if(arguments.length===0){for(e in this._events)e!=="removeListener"&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],Rt(r))this.removeListener(t,r);else if(r)for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},qe.prototype.listeners=function(t){var e;return!this._events||!this._events[t]?e=[]:Rt(this._events[t])?e=[this._events[t]]:e=this._events[t].slice(),e},qe.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(Rt(e))return 1;if(e)return e.length}return 0},qe.listenerCount=function(t,e){return t.listenerCount(e)};function Rt(t){return typeof t=="function"}function cd(t){return typeof t=="number"}function Nr(t){return typeof t=="object"&&t!==null}function So(t){return t===void 0}function ud(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),u=s.charCodeAt(0);if(r[u]!==255)throw new TypeError(s+" is ambiguous");r[u]=n}var c=t.length,h=t.charAt(0),f=Math.log(c)/Math.log(256),d=Math.log(256)/Math.log(c);function m(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(b.length===0)return"";for(var L=0,v=0,S=0,R=b.length;S!==R&&b[S]===0;)S++,L++;for(var A=(R-S)*d+1>>>0,D=new Uint8Array(A);S!==R;){for(var T=b[S],_=0,o=A-1;(T!==0||_<v)&&o!==-1;o--,_++)T+=256*D[o]>>>0,D[o]=T%c>>>0,T=T/c>>>0;if(T!==0)throw new Error("Non-zero carry");v=_,S++}for(var p=A-v;p!==A&&D[p]===0;)p++;for(var j=h.repeat(L);p<A;++p)j+=t.charAt(D[p]);return j}function C(b){if(typeof b!="string")throw new TypeError("Expected String");if(b.length===0)return new Uint8Array;var L=0;if(b[L]!==" "){for(var v=0,S=0;b[L]===h;)v++,L++;for(var R=(b.length-L)*f+1>>>0,A=new Uint8Array(R);b[L];){var D=r[b.charCodeAt(L)];if(D===255)return;for(var T=0,_=R-1;(D!==0||T<S)&&_!==-1;_--,T++)D+=c*A[_]>>>0,A[_]=D%256>>>0,D=D/256>>>0;if(D!==0)throw new Error("Non-zero carry");S=T,L++}if(b[L]!==" "){for(var o=R-S;o!==R&&A[o]===0;)o++;for(var p=new Uint8Array(v+(R-o)),j=v;o!==R;)p[j++]=A[o++];return p}}}function y(b){var L=C(b);if(L)return L;throw new Error(`Non-${e} character`)}return{encode:m,decodeUnsafe:C,decode:y}}var hd=ud,fd=hd;const xo=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},ld=t=>new TextEncoder().encode(t),dd=t=>new TextDecoder().decode(t);class pd{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class gd{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Oo(this,e)}}class vd{constructor(e){this.decoders=e}or(e){return Oo(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Oo=(t,e)=>new vd(ct(ct({},t.decoders||{[t.prefix]:t}),e.decoders||{[e.prefix]:e}));class _d{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new pd(e,r,i),this.decoder=new gd(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ei=({name:t,prefix:e,encode:r,decode:i})=>new _d(t,e,r,i),Tr=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=fd(r,e);return ei({prefix:t,name:e,encode:i,decode:s=>xo(n(s))})},yd=(t,e,r,i)=>{const n={};for(let d=0;d<e.length;++d)n[e[d]]=d;let s=t.length;for(;t[s-1]==="=";)--s;const u=new Uint8Array(s*r/8|0);let c=0,h=0,f=0;for(let d=0;d<s;++d){const m=n[t[d]];if(m===void 0)throw new SyntaxError(`Non-${i} character`);h=h<<r|m,c+=r,c>=8&&(c-=8,u[f++]=255&h>>c)}if(c>=r||255&h<<8-c)throw new SyntaxError("Unexpected end of data");return u},bd=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",u=0,c=0;for(let h=0;h<t.length;++h)for(c=c<<8|t[h],u+=8;u>r;)u-=r,s+=e[n&c>>u];if(u&&(s+=e[n&c<<r-u]),i)for(;s.length*r&7;)s+="=";return s},tt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>ei({prefix:e,name:t,encode(n){return bd(n,i,r)},decode(n){return yd(n,i,r,t)}}),wd=ei({prefix:"\0",name:"identity",encode:t=>dd(t),decode:t=>ld(t)});var Ed=Object.freeze({__proto__:null,identity:wd});const md=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Dd=Object.freeze({__proto__:null,base2:md});const Sd=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var xd=Object.freeze({__proto__:null,base8:Sd});const Od=Tr({prefix:"9",name:"base10",alphabet:"0123456789"});var Id=Object.freeze({__proto__:null,base10:Od});const Ad=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Nd=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Td=Object.freeze({__proto__:null,base16:Ad,base16upper:Nd});const Cd=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Rd=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ld=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Pd=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Fd=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ud=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Md=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),jd=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),$d=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var zd=Object.freeze({__proto__:null,base32:Cd,base32upper:Rd,base32pad:Ld,base32padupper:Pd,base32hex:Fd,base32hexupper:Ud,base32hexpad:Md,base32hexpadupper:jd,base32z:$d});const Bd=Tr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Kd=Tr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Hd=Object.freeze({__proto__:null,base36:Bd,base36upper:Kd});const Vd=Tr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qd=Tr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Gd=Object.freeze({__proto__:null,base58btc:Vd,base58flickr:qd});const Wd=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Yd=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Xd=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),kd=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Jd=Object.freeze({__proto__:null,base64:Wd,base64pad:Yd,base64url:Xd,base64urlpad:kd});const Io=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Zd=Io.reduce((t,e,r)=>(t[r]=e,t),[]),Qd=Io.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function ep(t){return t.reduce((e,r)=>(e+=Zd[r],e),"")}function tp(t){const e=[];for(const r of t){const i=Qd[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const rp=ei({prefix:"\u{1F680}",name:"base256emoji",encode:ep,decode:tp});var ip=Object.freeze({__proto__:null,base256emoji:rp}),np=No,Ao=128,sp=127,op=~sp,ap=Math.pow(2,31);function No(t,e,r){e=e||[],r=r||0;for(var i=r;t>=ap;)e[r++]=t&255|Ao,t/=128;for(;t&op;)e[r++]=t&255|Ao,t>>>=7;return e[r]=t|0,No.bytes=r-i+1,e}var cp=cn,up=128,To=127;function cn(t,i){var r=0,i=i||0,n=0,s=i,u,c=t.length;do{if(s>=c)throw cn.bytes=0,new RangeError("Could not decode varint");u=t[s++],r+=n<28?(u&To)<<n:(u&To)*Math.pow(2,n),n+=7}while(u>=up);return cn.bytes=s-i,r}var hp=Math.pow(2,7),fp=Math.pow(2,14),lp=Math.pow(2,21),dp=Math.pow(2,28),pp=Math.pow(2,35),gp=Math.pow(2,42),vp=Math.pow(2,49),_p=Math.pow(2,56),yp=Math.pow(2,63),bp=function(t){return t<hp?1:t<fp?2:t<lp?3:t<dp?4:t<pp?5:t<gp?6:t<vp?7:t<_p?8:t<yp?9:10},wp={encode:np,decode:cp,encodingLength:bp},Co=wp;const Ro=(t,e,r=0)=>(Co.encode(t,e,r),e),Lo=t=>Co.encodingLength(t),un=(t,e)=>{const r=e.byteLength,i=Lo(t),n=i+Lo(r),s=new Uint8Array(n+r);return Ro(t,s,0),Ro(r,s,i),s.set(e,n),new Ep(t,r,e,s)};class Ep{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}}const Po=({name:t,code:e,encode:r})=>new mp(t,e,r);class mp{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?un(this.code,r):r.then(i=>un(this.code,i))}else throw Error("Unknown type, must be binary type")}}const Fo=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Dp=Po({name:"sha2-256",code:18,encode:Fo("SHA-256")}),Sp=Po({name:"sha2-512",code:19,encode:Fo("SHA-512")});var xp=Object.freeze({__proto__:null,sha256:Dp,sha512:Sp});const Uo=0,Op="identity",Mo=xo;var Ip=Object.freeze({__proto__:null,identity:{code:Uo,name:Op,encode:Mo,digest:t=>un(Uo,Mo(t))}});new TextEncoder,new TextDecoder;const jo=ct(ct(ct(ct(ct(ct(ct(ct(ct(ct({},Ed),Dd),xd),Id),Td),zd),Hd),Gd),Jd),ip);ct(ct({},xp),Ip);function $o(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const zo=$o("utf8","u",t=>{const e=new TextDecoder("utf8");return"u"+e.decode(t)},t=>new TextEncoder().encode(t.substring(1))),hn=$o("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=new Uint8Array(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Ap=ct({utf8:zo,"utf-8":zo,hex:jo.base16,latin1:hn,ascii:hn,binary:hn},jo);function Np(t,e="utf8"){const r=Ap[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}const Bo="wc",Tp=2,fn="core",Cr=`${Bo}@${2}:${fn}:`,Cp={name:fn,logger:"error"},Rp={database:":memory:"},Lp="crypto",Ko="client_ed25519_seed",Pp=Ie.ONE_DAY,Fp="keychain",Up="0.3",Mp="messages",jp="0.3",$p=Ie.SIX_HOURS,zp="publisher",Ho="iridium",Bp="error",Kp="wss://relay.walletconnect.com",Hp="relayer",Rr={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error"},Vp="_subscription",ur={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},qp=Ie.ONE_SECOND,Gp="2.0.0-rc.0",Wp="0.3",Xt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync"},Yp="subscription",Xp="0.3",kp=Ie.FIVE_SECONDS*1e3;class Jp{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=Fp,this.version=Up,this.initialized=!1,this.storagePrefix=Cr,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=H("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Ws(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ys(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Zp{constructor(e,r,i){this.core=e,this.logger=r,this.name=Lp,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=ys(n);return _s(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=Pf();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),u=ys(s),c=Ji();return await Kh(c,n,Pp,u)},this.generateSharedKey=(n,s,u)=>{this.isInitialized();const c=this.getPrivateKey(n),h=Ff(c,s);return this.setSymKey(h,u)},this.setSymKey=async(n,s)=>{this.isInitialized();const u=s||Uf(n);return await this.keychain.set(u,n),u},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,u)=>{this.isInitialized();const c=Bs(u),h=Ii(s);if(Ks(c)){const C=c.senderPublicKey,y=c.receiverPublicKey;n=await this.generateSharedKey(C,y)}const f=this.getSymKey(n),{type:d,senderPublicKey:m}=c;return jf({type:d,symKey:f,message:h,senderPublicKey:m})},this.decode=async(n,s,u)=>{this.isInitialized();const c=Bf(s,u);if(Ks(c)){const d=c.receiverPublicKey,m=c.senderPublicKey;n=await this.generateSharedKey(d,m)}const h=this.getSymKey(n),f=$f({symKey:h,encoded:s});return Kn(f)},this.core=e,this.logger=xe.generateChildLogger(r,this.name),this.keychain=i||new Jp(this.core,this.logger)}get context(){return xe.getLoggerContext(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Ko)}catch{e=Ji(),await this.keychain.set(Ko,e)}return Np(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Qp extends Dc{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=Mp,this.version=jp,this.initialized=!1,this.storagePrefix=Cr,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=Jr(n);let u=this.messages.get(i);return typeof u>"u"&&(u={}),typeof u[s]<"u"||(u[s]=n,this.messages.set(i,u),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),u=Jr(n);return typeof s[u]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=xe.generateChildLogger(e,this.name),this.core=r}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Ws(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Ys(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class eg extends Sc{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new Qr.EventEmitter,this.name=zp,this.queue=new Map,this.publish=async(i,n,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});try{const u=s?.ttl||$p,c=Zi(s),h=s?.prompt||!1,f=s?.tag||0,d={topic:i,message:n,opts:{ttl:u,relay:c,prompt:h,tag:f}},m=Jr(n);this.queue.set(m,d),await this.rpcPublish(i,n,u,c,h,f),this.onPublish(m,d),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}})}catch(u){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(u),u}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return xe.getLoggerContext(this.logger)}rpcPublish(e,r,i,n,s,u){var c,h,f,d;const m={method:Qi(n.protocol).publish,params:{topic:e,message:r,ttl:i,prompt:s,tag:u}};return wt((c=m.params)==null?void 0:c.prompt)&&((h=m.params)==null||delete h.prompt),wt((f=m.params)==null?void 0:f.tag)&&((d=m.params)==null||delete d.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:m}),this.relayer.provider.request(m)}onPublish(e,r){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:r,message:i,opts:{ttl:n,relay:s,prompt:u,tag:c}}=e,h=Jr(i);await this.rpcPublish(r,i,n,s,u,c),this.onPublish(h,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(yr.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class tg{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var rg=Object.defineProperty,ig=Object.defineProperties,ng=Object.getOwnPropertyDescriptors,Vo=Object.getOwnPropertySymbols,sg=Object.prototype.hasOwnProperty,og=Object.prototype.propertyIsEnumerable,qo=(t,e,r)=>e in t?rg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ti=(t,e)=>{for(var r in e||(e={}))sg.call(e,r)&&qo(t,r,e[r]);if(Vo)for(var r of Vo(e))og.call(e,r)&&qo(t,r,e[r]);return t},ln=(t,e)=>ig(t,ng(e));class ag extends Ic{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new tg,this.events=new Qr.EventEmitter,this.name=Yp,this.version=Xp,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pendingSubInterval=20,this.storagePrefix=Cr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),await this.reset(),this.registerEventListeners(),this.onEnable())},this.subscribe=async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=Zi(n),u={topic:i,relay:s};this.pending.set(i,u);const c=await this.rpcSubscribe(i,s);return this.onSubscribe(c,u),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{this.isInitialized(),typeof n?.id<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>this.topics.includes(i)?!0:await new Promise((n,s)=>{const u=new Ie.Watch;u.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(i)&&this.topics.includes(i)&&(clearInterval(c),u.stop(this.pendingSubscriptionWatchLabel),n(!0)),u.elapsed(this.pendingSubscriptionWatchLabel)>=kp&&(clearInterval(c),u.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pendingSubInterval)}),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=Zi(i);await this.rpcUnsubscribe(e,r,n);const s=nt("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r){const i={method:Qi(r.protocol).subscribe,params:{topic:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),await this.relayer.provider.request(i)}rpcUnsubscribe(e,r,i){const n={method:Qi(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.provider.request(n)}onSubscribe(e,r){this.setSubscription(e,ln(ti({},r),{id:e})),this.pending.delete(r.topic)}onResubscribe(e,r){this.addSubscription(e,ln(ti({},r),{id:e})),this.pending.delete(r.topic)}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r))}addSubscription(e,r){this.subscriptions.set(e,ti({},r)),this.topicMap.set(r.topic,e),this.events.emit(Xt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Xt.deleted,ln(ti({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Xt.sync)}async reset(){!this.cached.length||await Promise.all(this.cached.map(async e=>await this.resubscribe(e)))}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async resubscribe(e){if(!this.ids.includes(e.id)){const{topic:r,relay:i}=e,n={topic:r,relay:i};this.pending.set(n.topic,n);const s=await this.rpcSubscribe(n.topic,n.relay);this.onResubscribe(s,n)}}async onConnect(){await this.reset(),this.onEnable()}onDisconnect(){this.onDisable()}checkPending(){this.pending.forEach(async e=>{const r=await this.rpcSubscribe(e.topic,e.relay);this.onSubscribe(r,e)})}registerEventListeners(){this.relayer.core.heartbeat.on(yr.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.provider.on(ur.connect,async()=>{await this.onConnect()}),this.relayer.provider.on(ur.disconnect,()=>{this.onDisconnect()}),this.events.on(Xt.created,async e=>{const r=Xt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()}),this.events.on(Xt.deleted,async e=>{const r=Xt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var cg=Object.defineProperty,Go=Object.getOwnPropertySymbols,ug=Object.prototype.hasOwnProperty,hg=Object.prototype.propertyIsEnumerable,Wo=(t,e,r)=>e in t?cg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,fg=(t,e)=>{for(var r in e||(e={}))ug.call(e,r)&&Wo(t,r,e[r]);if(Go)for(var r of Go(e))hg.call(e,r)&&Wo(t,r,e[r]);return t};class lg extends xc{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Qr.EventEmitter,this.name=Hp,this.initialized=!1,this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?xe.generateChildLogger(e.logger,this.name):di(xe.getDefaultLoggerOptions({level:e.logger||Bp})),this.messages=new Qp(this.logger,e.core),this.subscriber=new ag(this,this.logger),this.publisher=new eg(this,this.logger),this.relayUrl=e?.relayUrl||Kp,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized");const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=this.createProvider(e),await Promise.all([this.messages.init(),this.provider.connect(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return xe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r})}async subscribe(e,r){return this.isInitialized(),await this.subscriber.subscribe(e,r)}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}createProvider(e){return new td(new id(tl({sdkVersion:Gp,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e})))}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;return await this.subscriber.isSubscribed(r)?this.messages.has(r,i):!0}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),wo(e)){if(!e.method.endsWith(Vp))return;const r=e.params,{topic:i,message:n}=r.data,s={topic:i,message:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(fg({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(e),await this.onMessageEvent(s)}}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(Rr.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=vo(e.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(ur.payload,e=>this.onProviderPayload(e)),this.provider.on(ur.connect,()=>{this.events.emit(Rr.connect)}),this.provider.on(ur.disconnect,()=>{this.events.emit(Rr.disconnect),setTimeout(()=>{this.provider.connect()},Ie.toMiliseconds(qp))}),this.provider.on(ur.error,e=>this.events.emit(Rr.error,e))}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var dg=Object.defineProperty,Yo=Object.getOwnPropertySymbols,pg=Object.prototype.hasOwnProperty,gg=Object.prototype.propertyIsEnumerable,Xo=(t,e,r)=>e in t?dg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,ko=(t,e)=>{for(var r in e||(e={}))pg.call(e,r)&&Xo(t,r,e[r]);if(Yo)for(var r of Yo(e))gg.call(e,r)&&Xo(t,r,e[r]);return t};class dn extends Oc{constructor(e,r,i,n=Cr){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=Wp,this.cached=[],this.initialized=!1,this.storagePrefix=Cr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>{ml(s)?this.map.set(s.id,s):Dl(s)&&this.map.set(s.topic,s)}),this.cached=[],this.initialized=!0)},this.set=async(s,u)=>{this.isInitialized(),this.map.has(s)?await this.update(s,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:s,value:u}),this.map.set(s,u),await this.persist())},this.get=s=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:s}),this.getData(s)),this.getAll=s=>s?this.values.filter(u=>Object.keys(s).every(c=>nd(u[c],s[c]))):this.values,this.update=async(s,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:s,update:u});const c=ko(ko({},this.getData(s)),u);this.map.set(s,c),await this.persist()},this.delete=async(s,u)=>{this.isInitialized(),this.map.has(s)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:s,reason:u}),this.map.delete(s),await this.persist())},this.logger=xe.generateChildLogger(r,this.name),this.storagePrefix=n}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){const{message:i}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}var vg=Object.defineProperty,Jo=Object.getOwnPropertySymbols,_g=Object.prototype.hasOwnProperty,yg=Object.prototype.propertyIsEnumerable,Zo=(t,e,r)=>e in t?vg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Qo=(t,e)=>{for(var r in e||(e={}))_g.call(e,r)&&Zo(t,r,e[r]);if(Jo)for(var r of Jo(e))yg.call(e,r)&&Zo(t,r,e[r]);return t};class pn extends Ec{constructor(e){super(e),this.protocol=Bo,this.version=Tp,this.name=fn,this.events=new Qr.EventEmitter,this.initialized=!1,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.projectId=e?.projectId;const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:di(xe.getDefaultLoggerOptions({level:e?.logger||Cp.logger}));this.logger=xe.generateChildLogger(r,this.name),this.heartbeat=new yr.HeartBeat,this.crypto=new Zp(this,this.logger,e?.keychain),this.storage=e!=null&&e.storage?e.storage:new oc(Qo(Qo({},Rp),e?.storageOptions)),this.relayer=new lg({core:this,logger:this.logger,relayUrl:e?.relayUrl,projectId:this.projectId})}static async init(e){const r=new pn(e);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.relayer.init(),await this.heartbeat.init(),this.initialized=!0,this.logger.info("Core Initilization Success")}catch(e){throw this.logger.info("Core Initilization Failure"),this.logger.error(e.message),e}}}const bg=pn,gn="wc",vn=2,_n="client",hr=`${gn}@${vn}:${_n}:`,ri={name:_n,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},wg={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",pairing_ping:"pairing_ping",session_delete:"session_delete",session_expire:"session_expire",pairing_delete:"pairing_delete",pairing_expire:"pairing_expire",session_request:"session_request",session_event:"session_event",proposal_expire:"proposal_expire"},Eg={database:":memory:"},ea="expirer",_t={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},ta="0.3",mg=Ie.ONE_DAY,mt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},ra="history",ia="0.3",na="pairing",Dg=Ie.THIRTY_DAYS,sa="proposal",yn=cr(Ie.THIRTY_DAYS),oa="session",aa=Ie.SEVEN_DAYS,Lr=cr(aa),ca="engine",ii={wc_pairingDelete:{req:{prompt:!1,tag:1e3},res:{prompt:!1,tag:1001}},wc_pairingPing:{req:{prompt:!1,tag:1002},res:{prompt:!1,tag:1003}},wc_sessionPropose:{req:{prompt:!0,tag:1100},res:{prompt:!1,tag:1101}},wc_sessionSettle:{req:{prompt:!1,tag:1102},res:{prompt:!1,tag:1103}},wc_sessionUpdate:{req:{prompt:!1,tag:1104},res:{prompt:!1,tag:1105}},wc_sessionExtend:{req:{prompt:!1,tag:1106},res:{prompt:!1,tag:1107}},wc_sessionRequest:{req:{prompt:!0,tag:1108},res:{prompt:!1,tag:1109}},wc_sessionEvent:{req:{prompt:!0,tag:1110},res:{prompt:!1,tag:1111}},wc_sessionDelete:{req:{prompt:!1,tag:1112},res:{prompt:!1,tag:1113}},wc_sessionPing:{req:{prompt:!1,tag:1114},res:{prompt:!1,tag:1115}}};var Sg=Object.defineProperty,xg=Object.defineProperties,Og=Object.getOwnPropertyDescriptors,ua=Object.getOwnPropertySymbols,Ig=Object.prototype.hasOwnProperty,Ag=Object.prototype.propertyIsEnumerable,ha=(t,e,r)=>e in t?Sg(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,jt=(t,e)=>{for(var r in e||(e={}))Ig.call(e,r)&&ha(t,r,e[r]);if(ua)for(var r of ua(e))Ag.call(e,r)&&ha(t,r,e[r]);return t},fa=(t,e)=>xg(t,Og(e));class Ng extends Cc{constructor(e){super(e),this.events=new Ht,this.initialized=!1,this.name=ca,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0)},this.connect=async r=>{this.isInitialized(),await this.isValidConnect(r);const{pairingTopic:i,requiredNamespaces:n,relays:s}=r;let u=i,c,h=!1;if(u&&(h=this.client.pairing.get(u).active),!u||!h){const{topic:v,uri:S}=await this.createPairing();u=v,c=S}const f=await this.client.core.crypto.generateKeyPair(),d={requiredNamespaces:n,relays:s??[{protocol:Ho}],proposer:{publicKey:f,metadata:this.client.metadata}},{reject:m,resolve:C,done:y}=Yt();if(this.events.once(Fe("session_connect"),async({error:v,session:S})=>{if(v)m(v);else if(S){S.self.publicKey=f;const R=fa(jt({},S),{requiredNamespaces:n});await this.client.session.set(S.topic,R),await this.setExpiry(S.topic,S.expiry),u&&await this.client.pairing.update(u,{peerMetadata:S.peer.metadata}),C(R)}}),!u){const{message:v}=H("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(v)}const b=await this.sendRequest(u,"wc_sessionPropose",d),L=cr(Ie.FIVE_MINUTES);return await this.setProposal(b,jt({id:b,expiry:L},d)),{uri:c,approval:y}},this.pair=async r=>{this.isInitialized(),this.isValidPair(r);const{topic:i,symKey:n,relay:s}=fl(r.uri),u=cr(Ie.FIVE_MINUTES),c={topic:i,relay:s,expiry:u,active:!1};return await this.client.pairing.set(i,c),await this.client.core.crypto.setSymKey(n,i),await this.client.core.relayer.subscribe(i,{relay:s}),await this.setExpiry(i,u),c},this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:i,relayProtocol:n,namespaces:s}=r,{pairingTopic:u,proposer:c,requiredNamespaces:h}=this.client.proposal.get(i),f=await this.client.core.crypto.generateKeyPair(),d=c.publicKey,m=await this.client.core.crypto.generateSharedKey(f,d),C={relay:{protocol:n??"iridium"},namespaces:s,requiredNamespaces:h,controller:{publicKey:f,metadata:this.client.metadata},expiry:Lr};await this.client.core.relayer.subscribe(m);const y=await this.sendRequest(m,"wc_sessionSettle",C),{done:b,resolve:L,reject:v}=Yt();this.events.once(Fe("session_approve",y),({error:R})=>{R?v(R):L(this.client.session.get(m))});const S=fa(jt({},C),{topic:m,acknowledged:!1,self:C.controller,peer:{publicKey:c.publicKey,metadata:c.metadata},controller:f});return await this.client.session.set(m,S),await this.setExpiry(m,Lr),u&&await this.client.pairing.update(u,{peerMetadata:S.peer.metadata}),u&&i&&(await this.sendResult(i,u,{relay:{protocol:n??"iridium"},responderPublicKey:f}),await this.client.proposal.delete(i,nt("USER_DISCONNECTED")),await this.activatePairing(u)),{topic:m,acknowledged:b}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:i,reason:n}=r,{pairingTopic:s}=this.client.proposal.get(i);s&&(await this.sendError(i,s,n),await this.client.proposal.delete(i,nt("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:i,namespaces:n}=r,s=await this.sendRequest(i,"wc_sessionUpdate",{namespaces:n}),{done:u,resolve:c,reject:h}=Yt();return this.events.once(Fe("session_update",s),({error:f})=>{f?h(f):c()}),await this.client.session.update(i,{namespaces:n}),{acknowledged:u}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:i}=r,n=await this.sendRequest(i,"wc_sessionExtend",{}),{done:s,resolve:u,reject:c}=Yt();return this.events.once(Fe("session_extend",n),({error:h})=>{h?c(h):u()}),await this.setExpiry(i,Lr),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:i,request:n,topic:s}=r,u=await this.sendRequest(s,"wc_sessionRequest",{request:n,chainId:i}),{done:c,resolve:h,reject:f}=Yt();return this.events.once(Fe("session_request",u),({error:d,result:m})=>{d?f(d):h(m)}),await c()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n;Ct(n)?await this.sendResult(s,i,n.result):Et(n)&&await this.sendError(s,i,n.error)},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=await this.sendRequest(i,"wc_sessionPing",{}),{done:s,resolve:u,reject:c}=Yt();this.events.once(Fe("session_ping",n),({error:h})=>{h?c(h):u()}),await s()}else if(this.client.pairing.keys.includes(i)){const n=await this.sendRequest(i,"wc_pairingPing",{}),{done:s,resolve:u,reject:c}=Yt();this.events.once(Fe("pairing_ping",n),({error:h})=>{h?c(h):u()}),await s()}},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r;await this.sendRequest(i,"wc_sessionEvent",{event:n,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:i}=r;this.client.session.keys.includes(i)?(await this.sendRequest(i,"wc_sessionDelete",nt("USER_DISCONNECTED")),await this.deleteSession(i)):this.client.pairing.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",nt("USER_DISCONNECTED")),await this.deletePairing(i))},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>bl(i,r))),this.activatePairing=async r=>{await this.client.pairing.update(r,{active:!0,expiry:yn}),await this.setExpiry(r,yn)},this.deleteSession=async r=>{const{self:i}=this.client.session.get(r);await Promise.all([this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,nt("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),this.client.expirer.del(r)])},this.deletePairing=async r=>{await Promise.all([this.client.core.relayer.unsubscribe(r),this.client.pairing.delete(r,nt("USER_DISCONNECTED")),this.client.core.crypto.deleteSymKey(r),this.client.expirer.del(r)])},this.deleteProposal=async r=>{await Promise.all([this.client.proposal.delete(r,nt("USER_DISCONNECTED")),this.client.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.pairing.keys.includes(r)?await this.client.pairing.update(r,{expiry:i}):this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:i}),this.client.expirer.set(r,i)},this.setProposal=async(r,i)=>{await this.client.proposal.set(r,i),this.client.expirer.set(r,i.expiry)},this.sendRequest=async(r,i,n)=>{const s=on(i,n),u=await this.client.core.crypto.encode(r,s),c=ii[i].req;return await this.client.core.relayer.publish(r,u,c),this.client.history.set(r,s),s.id},this.sendResult=async(r,i,n)=>{const s=vo(r,n),u=await this.client.core.crypto.encode(i,s),c=await this.client.history.get(i,r),h=ii[c.request.method].res;await this.client.core.relayer.publish(i,u,h),await this.client.history.resolve(s)},this.sendError=async(r,i,n)=>{const s=_o(r,n),u=await this.client.core.crypto.encode(i,s),c=await this.client.history.get(i,r),h=ii[c.request.method].res;await this.client.core.relayer.publish(i,u,h),await this.client.history.resolve(s)},this.cleanup=async()=>{const r=[],i=[],n=[];this.client.session.getAll().forEach(s=>{Wt(s.expiry)&&r.push(s.topic)}),this.client.pairing.getAll().forEach(s=>{Wt(s.expiry)&&i.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{Wt(s.expiry)&&n.push(s.id)}),await Promise.all([...r.map(this.deleteSession),...i.map(this.deletePairing),...n.map(this.deleteProposal)])},this.onRelayEventRequest=r=>{const{topic:i,payload:n}=r,s=n.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(i,n);case"wc_sessionSettle":return this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return this.onSessionExtendRequest(i,n);case"wc_sessionPing":return this.onSessionPingRequest(i,n);case"wc_pairingPing":return this.onPairingPingRequest(i,n);case"wc_sessionDelete":return this.onSessionDeleteRequest(i,n);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,n);case"wc_sessionRequest":return this.onSessionRequest(i,n);case"wc_sessionEvent":return this.onSessionEventRequest(i,n);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n}=r,s=(await this.client.history.get(i,n.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_pairingPing":return this.onPairingPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidConnect(jt({},i.params));const u=cr(Ie.FIVE_MINUTES),c=jt({id:s,pairingTopic:r,expiry:u},n);await this.setProposal(s,c),this.client.events.emit("session_proposal",{id:s,params:c})}catch(u){await this.sendError(s,r,u),this.client.logger.error(u)}},this.onSessionProposeResponse=async(r,i)=>{const{id:n}=i;if(Ct(i)){const{result:s}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const u=this.client.proposal.get(n);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:u});const c=u.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const h=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:h});const f=await this.client.core.crypto.generateSharedKey(c,h);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:f});const d=await this.client.core.relayer.subscribe(f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:d}),await this.activatePairing(r)}else Et(i)&&(await this.client.proposal.delete(n,nt("USER_DISCONNECTED")),this.events.emit(Fe("session_connect"),{error:i.error}))},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:u,controller:c,expiry:h,namespaces:f}=i.params,d={topic:r,relay:u,expiry:h,namespaces:f,acknowledged:!0,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}};await this.sendResult(i.id,r,!0),this.events.emit(Fe("session_connect"),{session:d})}catch(u){await this.sendError(n,r,u),this.client.logger.error(u)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;Ct(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Fe("session_approve",n),{})):Et(i)&&(await this.client.session.delete(r,nt("USER_DISCONNECTED")),this.events.emit(Fe("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{this.isValidUpdate(jt({topic:r},n)),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(u){await this.sendError(s,r,u),this.client.logger.error(u)}},this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(Fe("session_update",n),{}):Et(i)&&this.events.emit(Fe("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Lr),await this.sendResult(n,r,!0),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(Fe("session_extend",n),{}):Et(i)&&this.events.emit(Fe("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(Fe("session_ping",n),{}):Et(i)&&this.events.emit(Fe("session_ping",n),{error:i.error})},this.onPairingPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult(n,r,!0),this.client.events.emit("pairing_ping",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onPairingPingResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(Fe("pairing_ping",n),{}):Et(i)&&this.events.emit(Fe("pairing_ping",n),{error:i.error})},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await this.sendResult(n,r,!0),await this.deleteSession(r),this.client.events.emit("session_delete",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onPairingDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),await this.sendResult(n,r,!0),await this.deletePairing(r),this.client.events.emit("pairing_delete",{id:n,topic:r})}catch(s){await this.sendError(n,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidRequest(jt({topic:r},s)),this.client.events.emit("session_request",{id:n,topic:r,params:s})}catch(u){await this.sendError(n,r,u),this.client.logger.error(u)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i;Ct(i)?this.events.emit(Fe("session_request",n),{result:i.result}):Et(i)&&this.events.emit(Fe("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidEmit(jt({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s})}catch(u){await this.sendError(n,r,u),this.client.logger.error(u)}},this.isValidConnect=async r=>{if(!vt(r)){const{message:c}=H("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(c)}const{pairingTopic:i,requiredNamespaces:n,relays:s}=r;wt(i)||await this.isValidPairingTopic(i);const u=Il(n,"connect()");if(u)throw new Error(u.message);if(!Al(s,!0)){const{message:c}=H("MISSING_OR_INVALID",`connect() relays: ${s}`);throw new Error(c)}},this.isValidPair=r=>{if(!vt(r)){const{message:i}=H("MISSING_OR_INVALID",`pair() params: ${r}`);throw new Error(i)}if(!El(r.uri)){const{message:i}=H("MISSING_OR_INVALID",`pair() uri: ${r.uri}`);throw new Error(i)}},this.isValidApprove=async r=>{if(!vt(r))throw new Error(H("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s}=r;await this.isValidProposalId(i);const u=this.client.proposal.get(i),c=rn(n,"approve()");if(c)throw new Error(c.message);const h=ao(u.requiredNamespaces,n,"update()");if(h)throw new Error(h.message);if(!st(s,!0)){const{message:f}=H("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(f)}},this.isValidReject=async r=>{if(!vt(r)){const{message:s}=H("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(await this.isValidProposalId(i),!Tl(n)){const{message:s}=H("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!vt(r)){const{message:f}=H("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(f)}const{relay:i,controller:n,namespaces:s,expiry:u}=r;if(!so(i)){const{message:f}=H("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(f)}const c=Sl(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);const h=rn(s,"onSessionSettleRequest()");if(h)throw new Error(h.message);if(Wt(u)){const{message:f}=H("EXPIRED","onSessionSettleRequest()");throw new Error(f)}},this.isValidUpdate=async r=>{if(!vt(r)){const{message:h}=H("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(h)}const{topic:i,namespaces:n}=r;await this.isValidSessionTopic(i);const s=this.client.session.get(i),u=rn(n,"update()");if(u)throw new Error(u.message);const c=ao(s.requiredNamespaces,n,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!vt(r)){const{message:n}=H("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!vt(r)){const{message:c}=H("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(c)}const{topic:i,request:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:u}=this.client.session.get(i);if(!oo(u,s)){const{message:c}=H("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(c)}if(!Cl(n)){const{message:c}=H("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(c)}if(!Pl(u,s,n.method)){const{message:c}=H("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(c)}},this.isValidRespond=async r=>{if(!vt(r)){const{message:s}=H("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:i,response:n}=r;if(await this.isValidSessionTopic(i),!Rl(n)){const{message:s}=H("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!vt(r)){const{message:n}=H("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!vt(r)){const{message:c}=H("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:u}=this.client.session.get(i);if(!oo(u,s)){const{message:c}=H("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!Ll(n)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}if(!Fl(u,s,n.name)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!vt(r)){const{message:n}=H("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)}}async createPairing(){const e=Ji(),r=await this.client.core.crypto.setSymKey(e),i=cr(Ie.FIVE_MINUTES),n={protocol:Ho},s={topic:r,expiry:i,relay:n,active:!1},u=dl({protocol:this.client.protocol,version:this.client.version,topic:r,symKey:e,relay:n});return await this.client.pairing.set(r,s),await this.client.core.relayer.subscribe(r),await this.setExpiry(r,i),{topic:r,uri:u}}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(Rr.message,async e=>{const{topic:r,message:i}=e,n=await this.client.core.crypto.decode(r,i);wo(n)?(this.client.history.set(r,n),this.onRelayEventRequest({topic:r,payload:n})):Eo(n)&&(await this.client.history.resolve(n),this.onRelayEventResponse({topic:r,payload:n}))})}registerExpirerEvents(){this.client.expirer.on(_t.expired,async e=>{const{topic:r,id:i}=nl(e.target);r?this.client.session.keys.includes(r)?(await this.deleteSession(r),this.client.events.emit("session_expire",{topic:r})):this.client.pairing.keys.includes(r)&&(await this.deletePairing(r),this.client.events.emit("pairing_expire",{topic:r})):i&&await this.deleteProposal(i)})}async isValidPairingTopic(e){if(!st(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.pairing.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Wt(this.client.pairing.get(e).expiry)){await this.deletePairing(e);const{message:r}=H("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!st(e,!1)){const{message:r}=H("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(!this.client.session.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Wt(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:r}=H("EXPIRED",`session topic: ${e}`);throw new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.pairing.keys.includes(e))await this.isValidPairingTopic(e);else if(st(e,!1)){const{message:r}=H("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=H("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!Nl(e)){const{message:r}=H("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=H("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Wt(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:r}=H("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}}class Tg extends Rc{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new Ht.EventEmitter,this.name=ea,this.version=ta,this.cached=[],this.initialized=!1,this.storagePrefix=hr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),u={target:s,expiry:n};this.expirations.set(s,u),this.checkExpiry(s,u),this.events.emit(_t.created,{target:s,expiration:u})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{this.isInitialized();const n=this.formatTarget(i);if(this.has(n)){const s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(_t.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return rl(e);if(typeof e=="number")return il(e);const{message:r}=H("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(_t.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;Ie.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(_t.expired,{target:e,expiration:r})}checkExpirations(){this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(yr.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(_t.created,e=>{const r=_t.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.expired,e=>{const r=_t.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(_t.deleted,e=>{const r=_t.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Cg extends mc{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new Ht.EventEmitter,this.name=ra,this.version=ia,this.cached=[],this.initialized=!1,this.storagePrefix=hr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const u={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s};this.records.set(u.id,u),this.events.emit(mt.created,u)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Et(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.events.emit(mt.updated,n))},this.get=async(i,n)=>{this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n});const s=await this.getRecord(n);if(s.topic!==i){const{message:u}=H("MISMATCHED_TOPIC",`${this.name}, ${n}`);throw this.logger.error(u),new Error(u)}return s},this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(mt.deleted,s)}})},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:on(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=H("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(mt.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(mt.created,e=>{const r=mt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(mt.updated,e=>{const r=mt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()}),this.events.on(mt.deleted,e=>{const r=mt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=H("NOT_INITIALIZED",this.name);throw new Error(e)}}}class Rg extends dn{constructor(e,r){super(e,r,na,hr),this.core=e,this.logger=r}}class Lg extends dn{constructor(e,r){super(e,r,sa,hr),this.core=e,this.logger=r}}class Pg extends dn{constructor(e,r){super(e,r,oa,hr),this.core=e,this.logger=r}}class ni extends Tc{constructor(e){super(e),this.protocol=gn,this.version=vn,this.name=ri.name,this.events=new Ht.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.name=e?.name||ri.name,this.metadata=e?.metadata||Jf();const r=typeof e?.logger<"u"&&typeof e?.logger!="string"?e.logger:di(xe.getDefaultLoggerOptions({level:e?.logger||ri.logger}));this.core=e?.core||new bg(e),this.logger=xe.generateChildLogger(r,this.name),this.pairing=new Rg(this.core,this.logger),this.session=new Pg(this.core,this.logger),this.proposal=new Lg(this.core,this.logger),this.history=new Cg(this.core,this.logger),this.expirer=new Tg(this.core,this.logger),this.engine=new Ng(this)}static async init(e){const r=new ni(e);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.pairing.init(),await this.session.init(),await this.proposal.init(),await this.history.init(),await this.expirer.init(),await this.engine.init(),this.logger.info("SignClient Initilization Success")}catch(e){throw this.logger.info("SignClient Initilization Failure"),this.logger.error(e.message),e}}}const Fg=ni;me.ENGINE_CONTEXT=ca,me.ENGINE_RPC_OPTS=ii,me.EXPIRER_CONTEXT=ea,me.EXPIRER_DEFAULT_TTL=mg,me.EXPIRER_EVENTS=_t,me.EXPIRER_STORAGE_VERSION=ta,me.HISTORY_CONTEXT=ra,me.HISTORY_EVENTS=mt,me.HISTORY_STORAGE_VERSION=ia,me.PAIRING_CONTEXT=na,me.PAIRING_DEFAULT_TTL=Dg,me.PROPOSAL_CONTEXT=sa,me.PROPOSAL_EXPIRY=yn,me.SESSION_CONTEXT=oa,me.SESSION_DEFAULT_TTL=aa,me.SESSION_EXPIRY=Lr,me.SIGN_CLIENT_CONTEXT=_n,me.SIGN_CLIENT_DEFAULT=ri,me.SIGN_CLIENT_EVENTS=wg,me.SIGN_CLIENT_PROTOCOL=gn,me.SIGN_CLIENT_STORAGE_OPTIONS=Eg,me.SIGN_CLIENT_STORAGE_PREFIX=hr,me.SIGN_CLIENT_VERSION=vn,me.SignClient=Fg,me.default=ni,Object.defineProperty(me,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
